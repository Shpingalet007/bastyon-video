"use strict";(self.webpackChunkpeertube_client=self.webpackChunkpeertube_client||[]).push([[586],{8453:(Q,P,o)=>{o.d(P,{J:()=>n});var i=o(42741),t=o(2402);let n=(()=>{class c{constructor(e){this.fromNowPipe=e,this.toggled=!1}ngOnChanges(){this.updateDates()}toggle(){this.toggled=!this.toggled}getTitle(){return this.toggled?this.dateRelative:this.dateAbsolute}getContent(){return this.toggled?this.dateAbsolute:this.dateRelative}updateDates(){this.dateRelative=this.fromNowPipe.transform(this.date),this.dateAbsolute=this.date.toLocaleDateString()}}return c.\u0275fac=function(e){return new(e||c)(i.Y36(t.d))},c.\u0275cmp=i.Xpm({type:c,selectors:[["my-date-toggle"]],inputs:{date:"date",toggled:"toggled"},features:[i.TTD],decls:2,vars:2,consts:[[1,"date-toggle",3,"title","click"]],template:function(e,_){1&e&&(i.TgZ(0,"span",0),i.NdJ("click",function(){return _.toggle()}),i._uU(1),i.qZA()),2&e&&(i.Q6J("title",_.getTitle()),i.xp6(1),i.hij(" ",_.getContent(),"\n"))},styles:[".date-toggle[_ngcontent-%COMP%]:hover{cursor:default}"]}),c})()},22557:(Q,P,o)=>{o.d(P,{CS:()=>i.C,Pd:()=>_});var i=o(56999),n=(o(96424),o(84167)),c=o(97694),A=o(13010),e=o(42741);let _=(()=>{class M{}return M.\u0275fac=function(h){return new(h||M)},M.\u0275mod=e.oAB({type:M}),M.\u0275inj=e.cJS({providers:[i.C],imports:[[A.n,n.hA,c.Y]]}),M})()},7160:(Q,P,o)=>{o.d(P,{z:()=>t});var i=o(42741);let t=(()=>{class n{}return n.\u0275fac=function(A){return new(A||n)},n.\u0275cmp=i.Xpm({type:n,selectors:[["my-live-documentation-link"]],decls:3,vars:0,consts:function(){let c;return c=" See " + "\ufffd#2\ufffd" + "the documentation" + "\ufffd/#2\ufffd" + " to learn how to use the PeerTube live streaming feature.\n",[c,["href","https://docs.joinpeertube.org/use-create-upload-video?id=publish-a-live-in-peertube-gt-v3","target","_blank","rel","noopener noreferrer"]]},template:function(A,e){1&A&&(i.TgZ(0,"div"),i.tHW(1,0),i._UZ(2,"a",1),i.N_p(),i.qZA())},encapsulation:2}),n})()},96424:(Q,P,o)=>{o.d(P,{y:()=>z});var i=o(42741),t=o(76476),n=o(56999),c=o(19895),A=o(16274),e=o(49705),_=o(49393),M=o(7160),T=o(2003);const h=["modal"];function b(I,U){1&I&&(i.TgZ(0,"div",22),i.SDv(1,23),i.qZA())}function H(I,U){1&I&&(i.TgZ(0,"div",22),i.SDv(1,24),i.qZA())}function w(I,U){if(1&I&&(i.TgZ(0,"div",10),i.TgZ(1,"div"),i.YNc(2,b,2,0,"div",11),i.YNc(3,H,2,0,"div",11),i.qZA(),i.TgZ(4,"div",12),i._UZ(5,"my-live-documentation-link"),i.qZA(),i.TgZ(6,"div",13),i.TgZ(7,"label",14),i.SDv(8,15),i.qZA(),i._UZ(9,"my-input-toggle-hidden",16),i.qZA(),i.TgZ(10,"div",13),i.TgZ(11,"label",17),i.SDv(12,18),i.qZA(),i._UZ(13,"my-input-toggle-hidden",19),i.TgZ(14,"div",20),i.SDv(15,21),i.qZA(),i.qZA(),i.qZA()),2&I){const u=i.oxw(2);i.xp6(2),i.Q6J("ngIf",u.live.permanentLive),i.xp6(1),i.Q6J("ngIf",u.live.saveReplay),i.xp6(6),i.Q6J("value",u.live.rtmpUrl)("withToggle",!1)("withCopy",!0)("show",!0)("readonly",!0),i.xp6(4),i.Q6J("value",u.live.streamKey)("withCopy",!0)("readonly",!0)}}const Y=function(I){return["/videos","update",I]};function W(I,U){if(1&I){const u=i.EpF();i.TgZ(0,"div",1),i.TgZ(1,"h4",2),i.SDv(2,3),i.qZA(),i.TgZ(3,"my-global-icon",4),i.NdJ("click",function(){return i.CHM(u).dismiss()}),i.qZA(),i.qZA(),i.YNc(4,w,16,10,"div",5),i.TgZ(5,"div",6),i.TgZ(6,"div",7),i.TgZ(7,"input",8),i.NdJ("click",function(){return i.CHM(u).dismiss()}),i.qZA(),i.TgZ(8,"my-edit-button",9),i.NdJ("click",function(){return i.CHM(u).dismiss()}),i.qZA(),i.qZA(),i.qZA()}if(2&I){const u=i.oxw();i.xp6(4),i.Q6J("ngIf",u.live),i.xp6(4),i.Q6J("routerLink",i.VKq(2,Y,u.video.uuid))}}let z=(()=>{class I{constructor(u,f){this.modalService=u,this.liveVideoService=f}show(u){this.video=u,this.live=void 0,this.loadLiveInfo(u),this.modalService.open(this.modal,{centered:!0})}loadLiveInfo(u){this.liveVideoService.getVideoLive(u.id).subscribe(f=>this.live=f)}}return I.\u0275fac=function(u){return new(u||I)(i.Y36(t.FF),i.Y36(n.C))},I.\u0275cmp=i.Xpm({type:I,selectors:[["my-live-stream-information"]],viewQuery:function(u,f){if(1&u&&i.Gf(h,7),2&u){let O;i.iGM(O=i.CRH())&&(f.modal=O.first)}},decls:2,vars:0,consts:function(){let U,u,f,O,D,L,k,V;return U="Live information",u="Tampar",f="Update live settings",O="Live RTMP Url",D="Live stream key",L="\u26A0\uFE0F Never share your stream key with anyone.",k="Permanent live",V="Replay will be saved",[["modal",""],[1,"modal-header"],[1,"modal-title"],U,["iconName","cross","aria-label","Close","role","button",3,"click"],["class","modal-body",4,"ngIf"],[1,"modal-footer"],[1,"form-group","inputs"],["type","button","role","button","value",u,1,"peertube-button","grey-button",3,"click"],["label",f,3,"routerLink","click"],[1,"modal-body"],["class","badge badge-info",4,"ngIf"],[1,"alert","alert-info"],[1,"form-group"],["for","liveVideoRTMPUrl"],O,["inputId","liveVideoRTMPUrl",3,"value","withToggle","withCopy","show","readonly"],["for","liveVideoStreamKey"],D,["inputId","liveVideoStreamKey",3,"value","withCopy","readonly"],[1,"form-group-description"],L,[1,"badge","badge-info"],k,V]},template:function(u,f){1&u&&i.YNc(0,W,9,4,"ng-template",null,0,i.W1O)},directives:[c.$,A.O5,e.M,_.rH,M.z,T.X],styles:["p-autocomplete[_ngcontent-%COMP%]{display:block}.form-group[_ngcontent-%COMP%]{margin:20px 0}.alert-info[_ngcontent-%COMP%]{margin:1rem 0}.badge[_ngcontent-%COMP%]{font-size:13px}"]}),I})()},56999:(Q,P,o)=>{o.d(P,{C:()=>e});var i=o(97142),t=o(24766),n=o(42741),c=o(31887),A=o(54755);class e{constructor(M,T){this.authHttp=M,this.restExtractor=T}goLive(M){return this.authHttp.post(e.BASE_VIDEO_LIVE_URL,M).pipe((0,i.K)(T=>this.restExtractor.handleError(T)))}getVideoLive(M){return this.authHttp.get(e.BASE_VIDEO_LIVE_URL+M).pipe((0,i.K)(T=>this.restExtractor.handleError(T)))}updateLive(M,T){return this.authHttp.put(e.BASE_VIDEO_LIVE_URL+M,T).pipe((0,i.K)(h=>this.restExtractor.handleError(h)))}}e.BASE_VIDEO_LIVE_URL=t.N.apiUrl+"/api/v1/videos/live/",e.\u0275fac=function(M){return new(M||e)(n.LFG(c.eN),n.LFG(A.DI))},e.\u0275prov=n.Yz7({token:e,factory:e.\u0275fac})},15586:(Q,P,o)=>{o.d(P,{F5:()=>U}),o(92046),o(53896),o(31470),o(98803),o(69469),o(75585),o(2461);var M=o(63192),T=o(84167),h=o(97694),b=o(13010),H=o(48600),w=o(60006),Y=o(34494),W=o(22557),z=o(54768),I=o(42741);let U=(()=>{class u{}return u.\u0275fac=function(O){return new(O||u)},u.\u0275mod=I.oAB({type:u}),u.\u0275inj=I.cJS({providers:[],imports:[[b.n,T.hA,H.DA,z.x,w.x,h.Y,W.Pd,Y.A,M.v]]}),u})()},92046:(Q,P,o)=>{o.d(P,{i:()=>k});var i=o(61855),t=o(42741),n=o(62026),c=o(54755),A=o(48600),e=o(16274),_=o(66865),M=o(53896),T=o(69886),h=o(90884),b=o(76476),H=o(81153),w=o(96424);const Y=["playlistDropdown"],W=["playlistAdd"],z=["videoDownloadModal"],I=["videoReportModal"],U=["videoBlockModal"],u=["liveStreamInformationModal"];function f(V,x){if(1&V){const v=t.EpF();t.TgZ(0,"div",8,9),t.NdJ("openChange",function(N){return t.CHM(v),t.MAs(5).openChange(N)}),t._UZ(2,"span",10),t.TgZ(3,"div",11),t._UZ(4,"my-video-add-to-playlist",12,13),t.qZA(),t.qZA()}if(2&V){const v=t.oxw(2);t.Q6J("placement",v.getPlaylistDropdownPlacement()),t.xp6(4),t.Q6J("video",v.video)("lazyLoad",!0)}}function O(V,x){1&V&&t._UZ(0,"my-live-stream-information",null,14)}const D=function(V){return{video:V}};function L(V,x){if(1&V){const v=t.EpF();t.ynx(0),t.YNc(1,f,6,3,"div",1),t.TgZ(2,"my-action-dropdown",2),t.NdJ("click",function(){return t.CHM(v),t.oxw().loadDropdownInformation()}),t.qZA(),t._UZ(3,"my-video-download",null,3),t._UZ(5,"my-video-report",4,5),t.TgZ(7,"my-video-block",6,7),t.NdJ("videoBlocked",function(){return t.CHM(v),t.oxw().onVideoBlocked()}),t.qZA(),t.YNc(9,O,2,0,"my-live-stream-information",0),t.BQk()}if(2&V){const v=t.oxw();t.xp6(1),t.Q6J("ngIf",v.isUserLoggedIn()&&v.displayOptions.playlist),t.xp6(1),t.Q6J("actions",v.videoActions)("label",v.label)("entry",t.VKq(11,D,v.video))("buttonSize",v.buttonSize)("placement",v.placement)("buttonDirection",v.buttonDirection)("buttonStyled",v.buttonStyled),t.xp6(3),t.Q6J("video",v.video),t.xp6(2),t.Q6J("video",v.video),t.xp6(2),t.Q6J("ngIf",v.displayOptions.liveInfo)}}let k=(()=>{class V{constructor(v,F,N,G,X,q,j,C){this.authService=v,this.notifier=F,this.confirmService=N,this.blocklistService=G,this.videoBlocklistService=X,this.screenService=q,this.videoService=j,this.redundancyService=C,this.videoCaptions=[],this.displayOptions={playlist:!1,download:!0,update:!0,blacklist:!0,delete:!0,report:!0,duplicate:!0,mute:!0,liveInfo:!1},this.placement="left",this.buttonStyled=!1,this.buttonSize="normal",this.buttonDirection="vertical",this.videoRemoved=new t.vpe,this.videoUnblocked=new t.vpe,this.videoBlocked=new t.vpe,this.videoAccountMuted=new t.vpe,this.modalOpened=new t.vpe,this.videoActions=[],this.loaded=!1}get user(){return this.authService.getUser()}ngOnChanges(){this.loaded&&(this.loaded=!1,this.playlistAdd&&this.playlistAdd.reload()),this.buildActions()}isUserLoggedIn(){return this.authService.isLoggedIn()}loadDropdownInformation(){!this.isUserLoggedIn()||!0===this.loaded||(this.loaded=!0,this.displayOptions.playlist&&this.playlistAdd.load())}showDownloadModal(){this.modalOpened.emit(),this.videoDownloadModal.show(this.video,this.videoCaptions)}showReportModal(){this.modalOpened.emit(),this.videoReportModal.show()}showBlockModal(){this.modalOpened.emit(),this.videoBlockModal.show()}showLiveInfoModal(v){this.modalOpened.emit(),this.liveStreamInformationModal.show(v)}isVideoUpdatable(){return this.video.isUpdatableBy(this.user)}isVideoRemovable(){return this.video.isRemovableBy(this.user)}isVideoBlockable(){return this.video.isBlockableBy(this.user)}isVideoUnblockable(){return this.video.isUnblockableBy(this.user)}isVideoLiveInfoAvailable(){return this.video.isLiveInfoAvailableBy(this.user)}isVideoDownloadable(){return this.video&&!0!==this.video.isLive&&this.video instanceof n.Ev&&this.video.downloadEnabled}canVideoBeDuplicated(){return!this.video.isLive&&this.video.canBeDuplicatedBy(this.user)}isVideoAccountMutable(){return this.video.account.id!==this.user.account.id}unblockVideo(){return(0,i.mG)(this,void 0,void 0,function*(){const v="Do you really want to unblock this video? It will be available again in the videos list.";!1!==(yield this.confirmService.confirm(v,"Desblocar"))&&this.videoBlocklistService.unblockVideo(this.video.id).subscribe({next:()=>{this.notifier.success("Video \n          " + this.video.name + " unblocked.\n        "),this.video.blacklisted=!1,this.video.blockedReason=null,this.videoUnblocked.emit()},error:N=>this.notifier.error(N.message)})})}removeVideo(){return(0,i.mG)(this,void 0,void 0,function*(){this.modalOpened.emit();let v="Vol\xE8tz vertadi\xE8rament suprimir aquesta vid\xE8o\u202F?";this.video.isLive&&(v+=" "+"The live stream will be automatically terminated."),!1!==(yield this.confirmService.confirm(v,"Suprimir"))&&this.videoService.removeVideo(this.video.id).subscribe({next:()=>{this.notifier.success("Vid\xE8o \n          " + this.video.name + " suprimida.\n        "),this.videoRemoved.emit()},error:N=>this.notifier.error(N.message)})})}duplicateVideo(){this.redundancyService.addVideoRedundancy(this.video).subscribe({next:()=>{const v="Aquesta vid\xE8o ser\xE0 duplicada sus v\xF2stra inst\xE0ncia.";this.notifier.success(v)},error:v=>this.notifier.error(v.message)})}muteVideoAccount(){const v={nameWithHost:n.vt.CREATE_BY_STRING(this.video.account.name,this.video.account.host)};this.blocklistService.blockAccountByUser(v).subscribe({next:()=>{this.notifier.success("Lo compte \n          " + v.nameWithHost + " es mut.\n        "),this.videoAccountMuted.emit()},error:F=>this.notifier.error(F.message)})}onVideoBlocked(){this.videoBlocked.emit()}getPlaylistDropdownPlacement(){return this.screenService.isInSmallView()?"bottom-right":"bottom-left bottom-right"}buildActions(){this.videoActions=[[{label:"Enregistrar dins la lista de lectura",handler:()=>this.playlistDropdown.toggle(),isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions.playlist,iconName:"playlist-add"}],[{label:"Telecargar",handler:()=>this.showDownloadModal(),isDisplayed:()=>this.displayOptions.download&&this.isVideoDownloadable(),iconName:"download"},{label:"Display live information",handler:({video:v})=>this.showLiveInfoModal(v),isDisplayed:()=>this.displayOptions.liveInfo&&this.isVideoLiveInfoAvailable(),iconName:"live"},{label:"Mandad\xEDs",linkBuilder:({video:v})=>["/videos/update",v.uuid],iconName:"edit",isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions.update&&this.isVideoUpdatable()},{label:"Block",handler:()=>this.showBlockModal(),iconName:"no",isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions.blacklist&&this.isVideoBlockable()},{label:"Desblocar",handler:()=>this.unblockVideo(),iconName:"undo",isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions.blacklist&&this.isVideoUnblockable()},{label:"Duplicar",handler:()=>this.duplicateVideo(),isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions.duplicate&&this.canVideoBeDuplicated(),iconName:"cloud-download"},{label:"Suprimir",handler:()=>this.removeVideo(),isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions.delete&&this.isVideoRemovable(),iconName:"delete"},{label:"Report",handler:()=>this.showReportModal(),isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions.report,iconName:"flag"}],[{label:"Mute account",handler:()=>this.muteVideoAccount(),isDisplayed:()=>this.authService.isLoggedIn()&&this.displayOptions.mute&&this.isVideoAccountMutable(),iconName:"no"}]]}}return V.\u0275fac=function(v){return new(v||V)(t.Y36(c.e8),t.Y36(c.d4),t.Y36(c.zM),t.Y36(A.I0),t.Y36(A.h7),t.Y36(c.H2),t.Y36(n.kI),t.Y36(n.Ve))},V.\u0275cmp=t.Xpm({type:V,selectors:[["my-video-actions-dropdown"]],viewQuery:function(v,F){if(1&v&&(t.Gf(Y,5),t.Gf(W,5),t.Gf(z,5),t.Gf(I,5),t.Gf(U,5),t.Gf(u,5)),2&v){let N;t.iGM(N=t.CRH())&&(F.playlistDropdown=N.first),t.iGM(N=t.CRH())&&(F.playlistAdd=N.first),t.iGM(N=t.CRH())&&(F.videoDownloadModal=N.first),t.iGM(N=t.CRH())&&(F.videoReportModal=N.first),t.iGM(N=t.CRH())&&(F.videoBlockModal=N.first),t.iGM(N=t.CRH())&&(F.liveStreamInformationModal=N.first)}},inputs:{video:"video",videoCaptions:"videoCaptions",displayOptions:"displayOptions",placement:"placement",label:"label",buttonStyled:"buttonStyled",buttonSize:"buttonSize",buttonDirection:"buttonDirection"},outputs:{videoRemoved:"videoRemoved",videoUnblocked:"videoUnblocked",videoBlocked:"videoBlocked",videoAccountMuted:"videoAccountMuted",modalOpened:"modalOpened"},features:[t.TTD],decls:1,vars:1,consts:function(){let x;return x="Open video actions",[[4,"ngIf"],["role","button","aria-label",x,"class","playlist-dropdown","ngbDropdown","","autoClose","outside",3,"placement","openChange",4,"ngIf"],["container","body",3,"actions","label","entry","buttonSize","placement","buttonDirection","buttonStyled","click"],["videoDownloadModal",""],[3,"video"],["videoReportModal",""],[3,"video","videoBlocked"],["videoBlockModal",""],["role","button","aria-label",x,"ngbDropdown","","autoClose","outside",1,"playlist-dropdown",3,"placement","openChange"],["playlistDropdown","ngbDropdown"],["ngbDropdownAnchor","",1,"anchor"],["ngbDropdownMenu",""],[3,"video","lazyLoad"],["playlistAdd",""],["liveStreamInformationModal",""]]},template:function(v,F){1&v&&t.YNc(0,L,10,13,"ng-container",0),2&v&&t.Q6J("ngIf",0!==F.videoActions.length)},directives:[e.O5,_.h,M.P,T.r,h.J,b.jt,b.YE,b.Vi,H.Z,w.y],styles:[".playlist-dropdown[_ngcontent-%COMP%]{position:absolute}.playlist-dropdown[_ngcontent-%COMP%]   .anchor[_ngcontent-%COMP%]{display:block;opacity:0}  .icon-playlist-add{left:2px}"]}),V})()},53896:(Q,P,o)=>{o.d(P,{P:()=>E});var i=o(61855),t=o(97600),n=o(45030),c=o(711),A=o(17310),e=o(42741),M=(o(359),o(62026)),T=o(54755),h=o(76476),b=o(16274),H=o(19895),w=o(93324),Y=o(26368);const W=["modal"];function z(s,g){if(1&s){const a=e.EpF();e.TgZ(0,"div",12),e.TgZ(1,"select",13),e.NdJ("ngModelChange",function(p){return e.CHM(a),e.oxw(2).type=p}),e.TgZ(2,"option",14),e.SDv(3,15),e.qZA(),e.TgZ(4,"option",16),e.SDv(5,17),e.qZA(),e.qZA(),e.qZA()}if(2&s){const a=e.oxw(2);e.xp6(1),e.Q6J("ngModel",a.type)}}function I(s,g){1&s&&(e.TgZ(0,"div",18),e.SDv(1,19),e.qZA())}function U(s,g){if(1&s){const a=e.EpF();e.TgZ(0,"div",33),e.TgZ(1,"button",34),e.NdJ("click",function(){return e.CHM(a),e.oxw(5).activateCopiedMessage()}),e._UZ(2,"span",35),e.qZA(),e.qZA()}if(2&s){e.oxw();const a=e.MAs(3);e.xp6(1),e.Q6J("cdkCopyToClipboard",a.value)}}function u(s,g){if(1&s){const a=e.EpF();e.TgZ(0,"div",28),e.TgZ(1,"div",29),e.TgZ(2,"input",30,31),e.NdJ("click",function(){return e.CHM(a),e.MAs(3).select()}),e.qZA(),e.YNc(4,U,3,1,"div",32),e.qZA(),e.qZA()}if(2&s){const a=e.oxw(4);e.xp6(2),e.Q6J("value",a.getLink()),e.xp6(2),e.Q6J("ngIf",!a.isConfidentialVideo())}}function f(s,g){if(1&s&&(e.ynx(0,24),e.TgZ(1,"a",25),e.SDv(2,26),e.qZA(),e.YNc(3,u,5,2,"ng-template",27),e.BQk()),2&s){const a=g.$implicit;e.Q6J("ngbNavItem",a.language.id),e.xp6(2),e.pQV(a.language.label),e.QtT(2)}}function O(s,g){if(1&s){const a=e.EpF();e.ynx(0),e.TgZ(1,"div",20,21),e.NdJ("activeIdChange",function(p){return e.CHM(a),e.oxw(2).onSubtitleIdChange(p)}),e.YNc(3,f,4,2,"ng-container",22),e.qZA(),e._UZ(4,"div",23),e.BQk()}if(2&s){const a=e.MAs(2),l=e.oxw(2);e.xp6(1),e.Q6J("activeId",l.subtitleLanguageId),e.xp6(2),e.Q6J("ngForOf",l.getCaptions()),e.xp6(1),e.Q6J("ngbNavOutlet",a)}}function D(s,g){if(1&s){const a=e.EpF();e.TgZ(0,"div",33),e.TgZ(1,"button",34),e.NdJ("click",function(){return e.CHM(a),e.oxw(5).activateCopiedMessage()}),e._UZ(2,"span",35),e.qZA(),e.qZA()}if(2&s){e.oxw();const a=e.MAs(3);e.xp6(1),e.Q6J("cdkCopyToClipboard",a.value)}}function L(s,g){if(1&s){const a=e.EpF();e.TgZ(0,"div",28),e.TgZ(1,"div",29),e.TgZ(2,"input",30,31),e.NdJ("click",function(){return e.CHM(a),e.MAs(3).select()}),e.qZA(),e.YNc(4,D,3,1,"div",32),e.qZA(),e.qZA()}if(2&s){const a=e.oxw(4);e.xp6(2),e.Q6J("value",a.getLink()),e.xp6(2),e.Q6J("ngIf",!a.isConfidentialVideo())}}function k(s,g){if(1&s&&(e.ynx(0,24),e.TgZ(1,"a",25),e.SDv(2,55),e.qZA(),e.YNc(3,L,5,2,"ng-template",27),e.BQk()),2&s){const a=g.$implicit;e.Q6J("ngbNavItem",a.resolution.id),e.xp6(2),e.pQV(a.resolution.label),e.QtT(2)}}function V(s,g){if(1&s&&(e.TgZ(0,"div",58),e.TgZ(1,"span",59),e.SDv(2,60),e.qZA(),e.TgZ(3,"span",61),e._uU(4),e.qZA(),e.qZA()),2&s){const a=g.$implicit;e.xp6(2),e.pQV(a.value.label),e.QtT(2),e.xp6(2),e.Oqu(a.value.value)}}function x(s,g){if(1&s&&(e.TgZ(0,"div",56),e.YNc(1,V,5,2,"div",57),e.ALo(2,"keyvalue"),e.qZA()),2&s){const a=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,a.videoFileMetadataFormat))}}function v(s,g){if(1&s&&(e.TgZ(0,"div",58),e.TgZ(1,"span",59),e.SDv(2,62),e.qZA(),e.TgZ(3,"span",61),e._uU(4),e.qZA(),e.qZA()),2&s){const a=g.$implicit;e.xp6(2),e.pQV(a.value.label),e.QtT(2),e.xp6(2),e.Oqu(a.value.value)}}function F(s,g){if(1&s&&(e.TgZ(0,"div",56),e.YNc(1,v,5,2,"div",57),e.ALo(2,"keyvalue"),e.qZA()),2&s){const a=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,a.videoFileMetadataVideoStream))}}function N(s,g){if(1&s&&(e.TgZ(0,"div",58),e.TgZ(1,"span",59),e.SDv(2,63),e.qZA(),e.TgZ(3,"span",61),e._uU(4),e.qZA(),e.qZA()),2&s){const a=g.$implicit;e.xp6(2),e.pQV(a.value.label),e.QtT(2),e.xp6(2),e.Oqu(a.value.value)}}function G(s,g){if(1&s&&(e.TgZ(0,"div",56),e.YNc(1,N,5,2,"div",57),e.ALo(2,"keyvalue"),e.qZA()),2&s){const a=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",e.lcZ(2,1,a.videoFileMetadataAudioStream))}}function X(s,g){if(1&s&&e._UZ(0,"div",23),2&s){e.oxw();const a=e.MAs(7);e.Q6J("ngbNavOutlet",a)}}function q(s,g){1&s&&(e.ynx(0),e._UZ(1,"span",64),e.ynx(2),e.SDv(3,65),e.BQk(),e.BQk())}function j(s,g){1&s&&(e.ynx(0),e._UZ(1,"span",66),e.ynx(2),e.SDv(3,67),e.BQk(),e.BQk())}function C(s,g){if(1&s){const a=e.EpF();e.ynx(0),e.TgZ(1,"div",20,36),e.NdJ("activeIdChange",function(p){return e.CHM(a),e.oxw(2).onResolutionIdChange(p)}),e.YNc(3,k,4,2,"ng-container",22),e.qZA(),e._UZ(4,"div",23),e.TgZ(5,"div",37),e.TgZ(6,"div",38,39),e.ynx(8,40),e.TgZ(9,"a",25),e.SDv(10,41),e.qZA(),e.YNc(11,x,3,3,"ng-template",27),e.ynx(12,42),e.TgZ(13,"a",25),e.SDv(14,43),e.qZA(),e.YNc(15,F,3,3,"ng-template",27),e.BQk(),e.ynx(16,42),e.TgZ(17,"a",25),e.SDv(18,44),e.qZA(),e.YNc(19,G,3,3,"ng-template",27),e.BQk(),e.BQk(),e.qZA(),e.YNc(20,X,1,1,"div",45),e.TgZ(21,"div",46),e.TgZ(22,"div",47),e.TgZ(23,"input",48),e.NdJ("ngModelChange",function(p){return e.CHM(a),e.oxw(2).downloadType=p}),e.qZA(),e.TgZ(24,"label",49),e.SDv(25,50),e.qZA(),e.qZA(),e.TgZ(26,"div",47),e.TgZ(27,"input",51),e.NdJ("ngModelChange",function(p){return e.CHM(a),e.oxw(2).downloadType=p}),e.qZA(),e.TgZ(28,"label",52),e.SDv(29,53),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(30,"div",54),e.NdJ("click",function(){e.CHM(a);const p=e.oxw(2);return p.isAdvancedCustomizationCollapsed=!p.isAdvancedCustomizationCollapsed}),e.YNc(31,q,4,0,"ng-container",8),e.YNc(32,j,4,0,"ng-container",8),e.qZA(),e.BQk()}if(2&s){const a=e.MAs(2),l=e.oxw(2);e.xp6(1),e.Q6J("activeId",l.resolutionId),e.xp6(2),e.Q6J("ngForOf",l.getVideoFiles()),e.xp6(1),e.Q6J("ngbNavOutlet",a),e.xp6(1),e.Q6J("ngbCollapse",l.isAdvancedCustomizationCollapsed),e.xp6(7),e.Q6J("disabled",void 0===l.videoFileMetadataVideoStream),e.xp6(4),e.Q6J("disabled",void 0===l.videoFileMetadataAudioStream),e.xp6(4),e.Q6J("ngIf",l.getFileMetadata()),e.xp6(3),e.Q6J("ngModel",l.downloadType),e.xp6(4),e.Q6J("ngModel",l.downloadType),e.xp6(3),e.uIk("aria-expanded",!l.isAdvancedCustomizationCollapsed),e.xp6(1),e.Q6J("ngIf",l.isAdvancedCustomizationCollapsed),e.xp6(1),e.Q6J("ngIf",!l.isAdvancedCustomizationCollapsed)}}function y(s,g){if(1&s){const a=e.EpF();e.TgZ(0,"div",1),e.TgZ(1,"h4",2),e.ynx(2),e.SDv(3,3),e.BQk(),e.YNc(4,z,6,1,"div",4),e.qZA(),e.TgZ(5,"my-global-icon",5),e.NdJ("click",function(){return e.CHM(a).close()}),e.qZA(),e.qZA(),e.TgZ(6,"div",6),e.YNc(7,I,2,0,"div",7),e.YNc(8,O,5,3,"ng-container",8),e.YNc(9,C,33,12,"ng-container",8),e.qZA(),e.TgZ(10,"div",9),e.TgZ(11,"input",10),e.NdJ("click",function(){return e.CHM(a).close()})("key.enter",function(){return e.CHM(a).close()}),e.qZA(),e.TgZ(12,"input",11),e.NdJ("click",function(){return e.CHM(a),e.oxw().download()}),e.qZA(),e.qZA()}if(2&s){const a=e.oxw();e.xp6(4),e.Q6J("ngIf",a.hasCaptions()),e.xp6(3),e.Q6J("ngIf",a.isConfidentialVideo()),e.xp6(1),e.Q6J("ngIf","subtitles"===a.type),e.xp6(1),e.Q6J("ngIf","video"===a.type)}}let E=(()=>{class s{constructor(a,l,p,r,S,d){this.localeId=a,this.notifier=l,this.modalService=p,this.videoService=r,this.auth=S,this.hooks=d,this.downloadType="direct",this.resolutionId=-1,this.isAdvancedCustomizationCollapsed=!0,this.type="video",this.bytesPipe=new M.$N,this.numbersPipe=new M.mI(this.localeId)}get typeText(){return"video"===this.type?"vid\xE8o":"sost\xEDtols"}getVideoFiles(){return this.video?this.video.getFiles():[]}getCaptions(){return this.videoCaptions?this.videoCaptions:[]}show(a,l){this.video=a,this.videoCaptions=l,this.activeModal=this.modalService.open(this.modal,{centered:!0}),this.hasFiles()&&this.onResolutionIdChange(this.getVideoFiles()[0].resolution.id),this.hasCaptions()&&(this.subtitleLanguageId=this.videoCaptions[0].language.id),this.activeModal.shown.subscribe(()=>{this.hooks.runAction("action:modal.video-download.shown","common")})}onClose(){this.video=void 0,this.videoCaptions=void 0}download(){window.location.assign(this.getLink()),this.activeModal.close()}getLink(){return"subtitles"===this.type&&this.videoCaptions?this.getCaptionLink():this.getVideoFileLink()}onResolutionIdChange(a){return(0,i.mG)(this,void 0,void 0,function*(){this.resolutionId=a;const l=this.getVideoFile();if(!l.metadata){if(!l.metadataUrl)return;yield this.hydrateMetadataFromMetadataUrl(l)}!l.metadata||(this.videoFileMetadataFormat=l?this.getMetadataFormat(l.metadata.format):void 0,this.videoFileMetadataVideoStream=l?this.getMetadataStream(l.metadata.streams,"video"):void 0,this.videoFileMetadataAudioStream=l?this.getMetadataStream(l.metadata.streams,"audio"):void 0)})}onSubtitleIdChange(a){this.subtitleLanguageId=a}hasFiles(){return 0!==this.getVideoFiles().length}getVideoFile(){const a=this.getVideoFiles().find(l=>l.resolution.id===this.resolutionId);if(a)return a;console.error("Could not find file with resolution %d.",this.resolutionId)}getVideoFileLink(){const a=this.getVideoFile();if(!a)return"";const l=this.isConfidentialVideo()?"?access_token="+this.auth.getAccessToken():"";switch(this.downloadType){case"direct":return a.fileDownloadUrl+l;case"torrent":return a.torrentDownloadUrl+l}}hasCaptions(){return 0!==this.getCaptions().length}getCaption(){const a=this.getCaptions().find(l=>l.language.id===this.subtitleLanguageId);if(a)return a;console.error("Cannot find caption %s.",this.subtitleLanguageId)}getCaptionLink(){const a=this.getCaption();return a?window.location.origin+a.captionPath:""}isConfidentialVideo(){return 3===this.video.privacy.id||4===this.video.privacy.id}activateCopiedMessage(){this.notifier.success("Copiat")}switchToType(a){this.type=a}getFileMetadata(){const a=this.getVideoFile();if(a)return a.metadata}getMetadataFormat(a){const l={encoder:r=>({label:"Encodar",value:r}),format_long_name:r=>({label:"Nom del format",value:r}),size:r=>({label:"Talha",value:this.bytesPipe.transform(r,2)}),bit_rate:r=>({label:"Debit binari",value:`${this.numbersPipe.transform(r)}bps`})},p=Object.assign(a,a.tags);return delete p.tags,(0,t.Z)((0,n.Z)(p,Object.keys(l)),(r,S)=>l[S](r))}getMetadataStream(a,l){const p=a.find(S=>S.codec_type===l);if(!p)return;let r={codec_long_name:S=>({label:"Codec",value:S}),profile:S=>({label:"Perfil",value:S}),bit_rate:S=>({label:"Debit binari",value:`${this.numbersPipe.transform(S)}bps`})};return r=Object.assign(r,"video"===l?{width:S=>({label:"Resolucion",value:`${S}x${p.height}`}),display_aspect_ratio:S=>({label:"Aspect ratio",value:S}),avg_frame_rate:S=>({label:"Average frame rate",value:S}),pix_fmt:S=>({label:"Pixel format",value:S})}:{sample_rate:S=>({label:"Sample rate",value:S}),channel_layout:S=>({label:"Channel Layout",value:S})}),(0,t.Z)((0,n.Z)(p,Object.keys(r)),(S,d)=>r[d](S))}hydrateMetadataFromMetadataUrl(a){const l=this.videoService.getVideoFileMetadata(a.metadataUrl).pipe((0,A.b)(p=>a.metadata=p));return(0,c.z)(l)}}return s.\u0275fac=function(a){return new(a||s)(e.Y36(e.soG),e.Y36(T.d4),e.Y36(h.FF),e.Y36(M.kI),e.Y36(T.e8),e.Y36(T.nT))},s.\u0275cmp=e.Xpm({type:s,selectors:[["my-video-download"]],viewQuery:function(a,l){if(1&a&&e.Gf(W,7),2&a){let p;e.iGM(p=e.CRH())&&(l.modal=p.first)}},decls:2,vars:0,consts:function(){let g,a,l,p,r,S,d,m,R,$,K,J,ee,te,ne,_e,oe,ie;return g="Telecargar",a="Anullar",l="Telecargar",p="Vid\xE8o",r="Subtitles",S=" The following link contains a private token and should not be shared with anyone. ",d="\n          " + "\ufffd0\ufffd" + "\n        ",m="Format",R="Flux de difusion",$="Flux \xE0udio",K="Telecargament dir\xE8cte",J="Torrent (fichi\xE8r .torrent)",ee="\n          " + "\ufffd0\ufffd" + "\n        ",te="\n          " + "\ufffd0\ufffd" + "\n        ",ne="\n          " + "\ufffd0\ufffd" + "\n        ",_e="\n          " + "\ufffd0\ufffd" + "\n        ",oe=" Advanced ",ie=" Simple ",[["modal",""],[1,"modal-header"],[1,"modal-title"],g,["class","peertube-select-container title-select",4,"ngIf"],["iconName","cross","aria-label","Close","role","button",3,"click"],[1,"modal-body"],["class","alert alert-warning",4,"ngIf"],[4,"ngIf"],[1,"modal-footer","inputs"],["type","button","role","button","value",a,1,"peertube-button","grey-button",3,"click","key.enter"],["type","submit","value",l,1,"peertube-button","orange-button",3,"click"],[1,"peertube-select-container","title-select"],["id","type","name","type",1,"form-control",3,"ngModel","ngModelChange"],["value","video"],p,["value","subtitles"],r,[1,"alert","alert-warning"],S,["ngbNav","",1,"nav-tabs",3,"activeId","activeIdChange"],["subtitleNav","ngbNav"],[3,"ngbNavItem",4,"ngFor","ngForOf"],[3,"ngbNavOutlet"],[3,"ngbNavItem"],["ngbNavLink",""],d,["ngbNavContent",""],[1,"nav-content"],[1,"input-group","input-group-sm"],["type","text","readonly","",1,"form-control","input-sm","readonly",3,"value","click"],["urlInput",""],["class","input-group-append",4,"ngIf"],[1,"input-group-append"],["type","button",1,"btn","btn-outline-secondary",3,"cdkCopyToClipboard","click"],[1,"glyphicon","glyphicon-duplicate"],["resolutionNav","ngbNav"],[1,"advanced-filters","collapse-transition",3,"ngbCollapse"],["ngbNav","",1,"nav-tabs","nav-metadata"],["navMetadata","ngbNav"],["ngbNavItem",""],m,["ngbNavItem","",3,"disabled"],R,$,[3,"ngbNavOutlet",4,"ngIf"],[1,"download-type"],[1,"peertube-radio-container"],["type","radio","name","download","id","download-direct","value","direct",3,"ngModel","ngModelChange"],["for","download-direct"],K,["type","radio","name","download","id","download-torrent","value","torrent",3,"ngModel","ngModelChange"],["for","download-torrent"],J,["role","button","aria-controls","collapseBasic",1,"advanced-filters-button",3,"click"],ee,[1,"file-metadata"],["class","metadata-attribute metadata-attribute-tags",4,"ngFor","ngForOf"],[1,"metadata-attribute","metadata-attribute-tags"],[1,"metadata-attribute-label"],te,[1,"metadata-attribute-value"],ne,_e,[1,"glyphicon","glyphicon-menu-down"],oe,[1,"glyphicon","glyphicon-menu-up"],ie]},template:function(a,l){1&a&&e.YNc(0,y,13,4,"ng-template",null,0,e.W1O)},directives:[b.O5,H.$,w.EJ,w.JJ,w.On,w.YN,w.Kr,h.Pz,b.sg,h.tO,h.nv,h.Vx,h.uN,Y.i3,h._D,w._,w.Fj],pipes:[b.Nd],styles:['.nav-content[_ngcontent-%COMP%]{margin-top:30px}.advanced-filters-button[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;margin-top:20px;font-size:16px;font-weight:600;cursor:pointer}.advanced-filters-button[_ngcontent-%COMP%]   .nav-tabs[_ngcontent-%COMP%]{margin-top:10x}@supports (margin-inline-end: 5px){.advanced-filters-button[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%]{margin-inline-end:5px}}@supports not (margin-inline-end: 5px){.advanced-filters-button[_ngcontent-%COMP%]   .glyphicon[_ngcontent-%COMP%]{margin-right:5px}}.peertube-select-container.title-select[_ngcontent-%COMP%]{padding:0;width:auto;border-radius:3px;color:var(--inputForegroundColor);background:var(--inputBackgroundColor);position:relative;font-size:15px;display:inline-block;margin:0 0 0 10px;vertical-align:top}.peertube-select-container.title-select.disabled[_ngcontent-%COMP%]{background-color:#e5e5e5}.peertube-select-container.title-select.disabled[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{cursor:default}@media screen and (max-width: auto){.peertube-select-container.title-select[_ngcontent-%COMP%]{width:100%}}.peertube-select-container.title-select[_ngcontent-%COMP%]:after{top:50%;right:calc(0% + 15px);content:" ";height:0;width:0;position:absolute;pointer-events:none;border:5px solid rgba(0,0,0,0);border-top-color:#000;margin-top:-2px;z-index:100}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:0 35px 0 12px;position:relative;border:1px solid #C6C6C6;background:transparent none;-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;height:30px;text-overflow:ellipsis;color:var(--mainForegroundColor)}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:-moz-focusring{color:transparent;text-shadow:0 0 0 #000}.peertube-select-container.title-select[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{color:#000}.peertube-select-container.title-select.peertube-select-button[_ngcontent-%COMP%]{background-color:#e5e5e5;color:var(--greyForegroundColor)}.peertube-select-container.title-select.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.title-select.peertube-select-button.focus-visible[_ngcontent-%COMP%]{box-shadow:0 0 0 .2rem #5858580d}.peertube-select-container.title-select.peertube-select-button[_ngcontent-%COMP%]:hover, .peertube-select-container.title-select.peertube-select-button[_ngcontent-%COMP%]:active, .peertube-select-container.title-select.peertube-select-button[_ngcontent-%COMP%]:focus, .peertube-select-container.title-select.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.title-select.peertube-select-button.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:#efefef}.peertube-select-container.title-select.peertube-select-button[disabled][_ngcontent-%COMP%], .peertube-select-container.title-select.peertube-select-button.disabled[_ngcontent-%COMP%]{cursor:default}.peertube-select-container.title-select.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .peertube-select-container.title-select.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .peertube-select-container.title-select.peertube-select-button[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.peertube-select-container.title-select.peertube-select-button[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .peertube-select-container.title-select.peertube-select-button[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{font-weight:600;color:var(--greyForegroundColor);border:0}#dropdown-download-type[_ngcontent-%COMP%]{cursor:pointer}.download-type[_ngcontent-%COMP%]{margin-top:20px}.download-type[_ngcontent-%COMP%]   .peertube-radio-container[_ngcontent-%COMP%]{display:inline-block}@supports (margin-inline-end: 30px){.download-type[_ngcontent-%COMP%]   .peertube-radio-container[_ngcontent-%COMP%]{margin-inline-end:30px}}@supports not (margin-inline-end: 30px){.download-type[_ngcontent-%COMP%]   .peertube-radio-container[_ngcontent-%COMP%]{margin-right:30px}}.nav-metadata[_ngcontent-%COMP%]{margin-top:20px}.file-metadata[_ngcontent-%COMP%]{padding:1rem}.file-metadata[_ngcontent-%COMP%]   .metadata-attribute[_ngcontent-%COMP%]{font-size:13px;display:block;margin-bottom:12px}.file-metadata[_ngcontent-%COMP%]   .metadata-attribute[_ngcontent-%COMP%]   .metadata-attribute-label[_ngcontent-%COMP%]{min-width:142px;display:inline-block;color:var(--greyForegroundColor);font-weight:700}@supports (padding-inline-end: 5px){.file-metadata[_ngcontent-%COMP%]   .metadata-attribute[_ngcontent-%COMP%]   .metadata-attribute-label[_ngcontent-%COMP%]{padding-inline-end:5px}}@supports not (padding-inline-end: 5px){.file-metadata[_ngcontent-%COMP%]   .metadata-attribute[_ngcontent-%COMP%]   .metadata-attribute-label[_ngcontent-%COMP%]{padding-right:5px}}.file-metadata[_ngcontent-%COMP%]   .metadata-attribute[_ngcontent-%COMP%]   a.metadata-attribute-value[_ngcontent-%COMP%]{color:var(--mainForegroundColor)}.file-metadata[_ngcontent-%COMP%]   .metadata-attribute[_ngcontent-%COMP%]   a.metadata-attribute-value[_ngcontent-%COMP%]:hover, .file-metadata[_ngcontent-%COMP%]   .metadata-attribute[_ngcontent-%COMP%]   a.metadata-attribute-value[_ngcontent-%COMP%]:focus, .file-metadata[_ngcontent-%COMP%]   .metadata-attribute[_ngcontent-%COMP%]   a.metadata-attribute-value[_ngcontent-%COMP%]:active{text-decoration:none!important;outline:none!important}.file-metadata[_ngcontent-%COMP%]   .metadata-attribute[_ngcontent-%COMP%]   a.metadata-attribute-value[_ngcontent-%COMP%]:hover{opacity:.9}.file-metadata[_ngcontent-%COMP%]   .metadata-attribute.metadata-attribute-tags[_ngcontent-%COMP%]   .metadata-attribute-value[_ngcontent-%COMP%]:not(:nth-child(2)):before{content:", "}']}),s})()},31470:(Q,P,o)=>{o.d(P,{Y:()=>s});var i=o(57115),n=o(42741),c=o(54755),A=o(12886),e=o(93324),_=o(62026),M=o(16274),T=o(19895),h=o(21499),b=o(76476),H=o(80403),w=o(56671),Y=o(49393),W=o(24333);function z(g,a){if(1&g){const l=n.EpF();n.TgZ(0,"div",45),n.tHW(1,46),n.TgZ(2,"a",47),n.TgZ(3,"span",48),n.NdJ("click",function(r){return n.CHM(l),n.oxw().onAccountSettingsClick(r)}),n.qZA(),n.qZA(),n.N_p(),n.qZA()}if(2&g){const l=a.$implicit;n.xp6(2),n.Q6J("fragment",l)}}function I(g,a){1&g&&(n.ynx(0),n.SDv(1,49),n.BQk())}function U(g,a){1&g&&(n.ynx(0),n.SDv(1,50),n.BQk())}function u(g,a){if(1&g&&(n.ynx(0),n._uU(1),n.BQk()),2&g){const l=n.oxw().$implicit;n.xp6(1),n.hij(": ",l.value,"")}}function f(g,a){1&g&&n._UZ(0,"my-global-icon",53)}const O=function(g){return{"can-remove":g}};function D(g,a){if(1&g){const l=n.EpF();n.TgZ(0,"div",51),n.NdJ("click",function(){const S=n.CHM(l).$implicit;return n.oxw().resetFilter(S.key,S.canRemove)}),n.TgZ(1,"span"),n._uU(2),n.YNc(3,u,2,1,"ng-container",5),n.qZA(),n.YNc(4,f,1,0,"my-global-icon",52),n.qZA()}if(2&g){const l=a.$implicit,p=n.oxw();n.Q6J("ngClass",n.VKq(5,O,l.canRemove))("title",p.getFilterTitle(l.canRemove)),n.xp6(2),n.hij(" ",l.label," "),n.xp6(1),n.Q6J("ngIf",l.value),n.xp6(1),n.Q6J("ngIf",l.canRemove)}}function L(g,a){1&g&&(n.TgZ(0,"ng-option",54),n.tHW(1,55),n._UZ(2,"strong"),n.N_p(),n.qZA())}function k(g,a){1&g&&(n.TgZ(0,"ng-option",56),n.tHW(1,57),n._UZ(2,"strong"),n.N_p(),n.qZA())}function V(g,a){1&g&&(n.TgZ(0,"ng-option",58),n.tHW(1,59),n._UZ(2,"strong"),n.N_p(),n.qZA())}function x(g,a){1&g&&(n.TgZ(0,"ng-option",60),n.tHW(1,61),n._UZ(2,"strong"),n.N_p(),n.qZA())}function v(g,a){}function F(g,a){1&g&&n.YNc(0,v,0,0,"ng-template")}function N(g,a){}function G(g,a){1&g&&n.YNc(0,N,0,0,"ng-template")}function X(g,a){1&g&&(n.TgZ(0,"div",17),n.TgZ(1,"label",62),n.SDv(2,63),n.qZA(),n.TgZ(3,"div",24),n._UZ(4,"input",64),n.TgZ(5,"label",65),n.SDv(6,66),n.qZA(),n.qZA(),n.TgZ(7,"div",24),n._UZ(8,"input",67),n.TgZ(9,"label",68),n.SDv(10,69),n.qZA(),n.qZA(),n.qZA())}function q(g,a){1&g&&(n.TgZ(0,"div",17),n.TgZ(1,"label",70),n.SDv(2,71),n.qZA(),n._UZ(3,"my-peertube-checkbox",72),n.qZA())}const j=function(g){return{active:g}},C=function(){return{$implicit:"video-languages-subtitles"}},y=function(){return{$implicit:"video-sensitive-content-policy"}},E=i("peertube:videos:VideoFiltersHeaderComponent");let s=(()=>{class g{constructor(l,p,r,S){this.auth=l,this.serverService=p,this.fb=r,this.modalService=S,this.displayModerationBlock=!1,this.hideScope=!1,this.filtersChanged=new n.vpe,this.areFiltersCollapsed=!0}ngOnInit(){this.form=this.fb.group({sort:[""],nsfw:[""],languageOneOf:[""],categoryOneOf:[""],scope:[""],allVideos:[""],live:[""]}),this.patchForm(!1),this.filters.onChange(()=>{this.patchForm(!1)}),this.form.valueChanges.subscribe(l=>{E("Loading values from form: %O",l),this.filters.load(l),this.filtersChanged.emit()})}ngOnDestroy(){this.routeSub&&this.routeSub.unsubscribe()}canSeeAllVideos(){return!(!this.auth.isLoggedIn()||!this.displayModerationBlock)&&this.auth.getUser().hasRight(20)}isTrendingSortEnabled(l){const r=this.serverService.getHTMLConfig().trending.videos.algorithms.enabled.includes(l);return"best"===l?r&&this.auth.isLoggedIn():r}resetFilter(l,p){!p||(this.filters.reset(l),this.patchForm(!1),this.filtersChanged.emit())}getFilterTitle(l){return l?"Remove this filter":""}onAccountSettingsClick(l){this.auth.isLoggedIn()||(l.preventDefault(),l.stopPropagation(),this.modalService.openQuickSettingsSubject.next())}patchForm(l){const p=this.filters.toFormObject();this.form.patchValue(p,{emitEvent:l}),E("Patched form: %O",p)}}return g.\u0275fac=function(l){return new(l||g)(n.Y36(c.e8),n.Y36(A.N),n.Y36(e.qu),n.Y36(_.tj))},g.\u0275cmp=n.Xpm({type:g,selectors:[["my-video-filters-header"]],inputs:{filters:"filters",displayModerationBlock:"displayModerationBlock",hideScope:"hideScope"},outputs:{filtersChanged:"filtersChanged"},decls:58,vars:25,consts:function(){let a,l,p,r,S,d,m,R,$,K,J,ee,te,ne,_e,oe,ie,B,ae,se,le;return a="Sort by " + "\ufffd#13\ufffd" + "\"Recently Added\"" + "\ufffd/#13\ufffd" + "",l="Languages:",p="Sensitive content:",r="Hide",S="Type:",d="VOD & Live videos",m="Live videos",R="VOD videos",$="Categories:",K=" Update " + "\ufffd#2\ufffd" + "" + "\ufffd#3\ufffd" + "your settings" + "\ufffd/#3\ufffd" + "" + "\ufffd/#2\ufffd" + "",J="More filters",ee="Less filters",te="Sort by " + "\ufffd#2\ufffd" + "\"Views\"" + "\ufffd/#2\ufffd" + "",ne="Sort by " + "\ufffd#2\ufffd" + "\"Hot\"" + "\ufffd/#2\ufffd" + "",_e="Sort by " + "\ufffd#2\ufffd" + "\"Best\"" + "\ufffd/#2\ufffd" + "",oe="Sort by " + "\ufffd#2\ufffd" + "\"Likes\"" + "\ufffd/#2\ufffd" + "",ie="Scope:",B="Local videos (this instance)",ae="Federated videos (this instance + followed instances)",se="Moderation:",le="Display all videos (private, unlisted or not yet published)",[["updateSettings",""],[1,"root",3,"formGroup"],[1,"first-row"],[1,"active-filters"],["role","button","aria-controls","collapseBasic",1,"pastille","filters-toggle",3,"ngClass","click"],[4,"ngIf"],["iconName","chevrons-up"],["class","active-filter pastille",3,"ngClass","title","click",4,"ngFor","ngForOf"],["formControlName","sort",1,"sort",3,"clearable","searchable"],["value","-publishedAt"],a,["value","-trending",4,"ngIf"],["value","-hot",4,"ngIf"],["value","-best",4,"ngIf"],["value","-likes",4,"ngIf"],[1,"collapse-transition",3,"ngbCollapse"],[1,"filters"],[1,"form-group"],["for","languageOneOf",1,"with-description"],l,[4,"ngTemplateOutlet","ngTemplateOutletContext"],["formControlName","languageOneOf",3,"maxLanguages"],["for","nsfw",1,"with-description"],p,[1,"peertube-radio-container"],["formControlName","nsfw","type","radio","name","nsfw","id","nsfwBoth","value","both"],["for","nsfwBoth"],["formControlName","nsfw","type","radio","name","nsfw","id","nsfwFalse","value","false"],["for","nsfwFalse"],r,["class","form-group",4,"ngIf"],["for","type"],S,["formControlName","live","type","radio","name","live","id","liveBoth","value","both"],["for","liveBoth"],d,["formControlName","live","type","radio","name","live","id","liveTrue","value","true"],["for","liveTrue"],m,["formControlName","live","type","radio","name","live","id","liveFalse","value","false"],["for","liveFalse"],R,["for","categoryOneOf"],$,["formControlName","categoryOneOf"],[1,"label-description","text-muted"],K,["routerLink","/my-account/settings",3,"fragment"],[3,"click"],J,ee,[1,"active-filter","pastille",3,"ngClass","title","click"],["iconName","cross",4,"ngIf"],["iconName","cross"],["value","-trending"],te,["value","-hot"],ne,["value","-best"],_e,["value","-likes"],oe,["for","scope"],ie,["formControlName","scope","type","radio","name","scope","id","scopeLocal","value","local"],["for","scopeLocal"],B,["formControlName","scope","type","radio","name","scope","id","scopeFederated","value","federated"],["for","scopeFederated"],ae,["for","allVideos"],se,["formControlName","allVideos","inputName","allVideos","labelText",le]]},template:function(l,p){if(1&l&&(n.YNc(0,z,4,1,"ng-template",null,0,n.W1O),n.TgZ(2,"div",1),n.TgZ(3,"div",2),n.TgZ(4,"div",3),n.TgZ(5,"div",4),n.NdJ("click",function(){return p.areFiltersCollapsed=!p.areFiltersCollapsed}),n.YNc(6,I,2,0,"ng-container",5),n.YNc(7,U,2,0,"ng-container",5),n._UZ(8,"my-global-icon",6),n.qZA(),n.YNc(9,D,5,7,"div",7),n.qZA(),n.TgZ(10,"ng-select",8),n.TgZ(11,"ng-option",9),n.tHW(12,10),n._UZ(13,"strong"),n.N_p(),n.qZA(),n.YNc(14,L,3,0,"ng-option",11),n.YNc(15,k,3,0,"ng-option",12),n.YNc(16,V,3,0,"ng-option",13),n.YNc(17,x,3,0,"ng-option",14),n.qZA(),n.qZA(),n.TgZ(18,"div",15),n.TgZ(19,"div",16),n.TgZ(20,"div",17),n.TgZ(21,"label",18),n.SDv(22,19),n.qZA(),n.YNc(23,F,1,0,void 0,20),n._UZ(24,"my-select-languages",21),n.qZA(),n.TgZ(25,"div",17),n.TgZ(26,"label",22),n.SDv(27,23),n.qZA(),n.YNc(28,G,1,0,void 0,20),n.TgZ(29,"div",24),n._UZ(30,"input",25),n.TgZ(31,"label",26),n._uU(32),n.qZA(),n.qZA(),n.TgZ(33,"div",24),n._UZ(34,"input",27),n.TgZ(35,"label",28),n.SDv(36,29),n.qZA(),n.qZA(),n.qZA(),n.YNc(37,X,11,0,"div",30),n.TgZ(38,"div",17),n.TgZ(39,"label",31),n.SDv(40,32),n.qZA(),n.TgZ(41,"div",24),n._UZ(42,"input",33),n.TgZ(43,"label",34),n.SDv(44,35),n.qZA(),n.qZA(),n.TgZ(45,"div",24),n._UZ(46,"input",36),n.TgZ(47,"label",37),n.SDv(48,38),n.qZA(),n.qZA(),n.TgZ(49,"div",24),n._UZ(50,"input",39),n.TgZ(51,"label",40),n.SDv(52,41),n.qZA(),n.qZA(),n.qZA(),n.TgZ(53,"div",17),n.TgZ(54,"label",42),n.SDv(55,43),n.qZA(),n._UZ(56,"my-select-categories",44),n.qZA(),n.YNc(57,q,4,0,"div",30),n.qZA(),n.qZA(),n.qZA()),2&l){const r=n.MAs(1);n.xp6(2),n.Q6J("formGroup",p.form),n.xp6(3),n.Q6J("ngClass",n.VKq(21,j,!p.areFiltersCollapsed)),n.uIk("aria-expanded",!p.areFiltersCollapsed),n.xp6(1),n.Q6J("ngIf",p.areFiltersCollapsed),n.xp6(1),n.Q6J("ngIf",!p.areFiltersCollapsed),n.xp6(2),n.Q6J("ngForOf",p.filters.getActiveFilters()),n.xp6(1),n.Q6J("clearable",!1)("searchable",!1),n.xp6(4),n.Q6J("ngIf",p.isTrendingSortEnabled("most-viewed")),n.xp6(1),n.Q6J("ngIf",p.isTrendingSortEnabled("hot")),n.xp6(1),n.Q6J("ngIf",p.isTrendingSortEnabled("best")),n.xp6(1),n.Q6J("ngIf",p.isTrendingSortEnabled("most-liked")),n.xp6(1),n.Q6J("ngbCollapse",p.areFiltersCollapsed),n.xp6(5),n.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",n.DdM(23,C)),n.xp6(1),n.Q6J("maxLanguages",20),n.xp6(4),n.Q6J("ngTemplateOutlet",r)("ngTemplateOutletContext",n.DdM(24,y)),n.xp6(4),n.Oqu(p.filters.getNSFWDisplayLabel()),n.xp6(5),n.Q6J("ngIf",!p.hideScope),n.xp6(20),n.Q6J("ngIf",p.canSeeAllVideos())}},directives:[e.JL,e.sg,M.mk,M.O5,T.$,M.sg,h.w9,e.JJ,e.u,h.xv,b._D,M.tP,H.U,e.Fj,e._,w.Y,Y.yS,W.P],styles:[".root[_ngcontent-%COMP%]{margin-bottom:45px;font-size:15px}.first-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.active-filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-top:25px;border-bottom:1px solid rgba(0,0,0,.1)}.filters[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{font-weight:400}.filters[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]:first-child{display:block}.filters[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]:first-child.with-description{margin-bottom:0}.filters[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]:first-child:not(.with-description){margin-bottom:10px}@supports (margin-inline-end: 30px){.filters[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-inline-end:30px}}@supports not (margin-inline-end: 30px){.filters[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-right:30px}}.pastille[_ngcontent-%COMP%]{border-radius:24px;padding:4px 15px;font-size:16px;margin-bottom:15px;cursor:pointer}@supports (margin-inline-end: 15px){.pastille[_ngcontent-%COMP%]{margin-inline-end:15px}}@supports not (margin-inline-end: 15px){.pastille[_ngcontent-%COMP%]{margin-right:15px}}.filters-toggle[_ngcontent-%COMP%]{border:2px solid var(--mainForegroundColor)}@supports (margin-inline-start: 5px){.filters-toggle[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{margin-inline-start:5px}}@supports not (margin-inline-start: 5px){.filters-toggle[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{margin-left:5px}}.filters-toggle.active[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{position:relative;top:-1px}.filters-toggle[_ngcontent-%COMP%]:not(.active)   my-global-icon[_ngcontent-%COMP%]     svg{transform:rotate(180deg)}.filters-toggle[_ngcontent-%COMP%], .active-filter.can-remove[_ngcontent-%COMP%]{padding:4px 11px 4px 15px}.active-filter[_ngcontent-%COMP%]{background-color:var(--channelBackgroundColor);display:flex;align-items:center}.active-filter[_ngcontent-%COMP%]:not(.can-remove){cursor:default}.active-filter.can-remove[_ngcontent-%COMP%]:hover{opacity:.9}.active-filter[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{width:16px;color:var(--greyForegroundColor)}@supports (margin-inline-start: 10px){.active-filter[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{margin-inline-start:10px}}@supports not (margin-inline-start: 10px){.active-filter[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]{margin-left:10px}}.sort[_ngcontent-%COMP%]{min-width:200px;max-width:300px;height:-webkit-min-content;height:min-content}.sort[_ngcontent-%COMP%]     .ng-select-container{height:33px!important}@supports (margin-inline-start: 5px){.sort[_ngcontent-%COMP%]     .ng-value strong{margin-inline-start:5px}}@supports not (margin-inline-start: 5px){.sort[_ngcontent-%COMP%]     .ng-value strong{margin-left:5px}}my-select-languages[_ngcontent-%COMP%], my-select-categories[_ngcontent-%COMP%]{width:300px;display:inline-block}.label-description[_ngcontent-%COMP%]{font-size:12px;font-style:italic;margin-bottom:10px}.label-description[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--mainColor)}@media screen and (max-width: 800px){.first-row[_ngcontent-%COMP%]{flex-direction:column}}"]}),g})()},98803:(Q,P,o)=>{o.d(P,{P:()=>t});var i=o(86804);class t{constructor(c,A,e=[]){this.defaultValues=new Map([["sort","-publishedAt"],["nsfw","false"],["languageOneOf",void 0],["categoryOneOf",void 0],["scope","federated"],["allVideos",!1],["live","both"]]),this.activeFilters=[],this.onChangeCallbacks=[],this.hiddenFields=[],this.setDefaultSort(c),this.setDefaultScope(A),this.hiddenFields=e,this.reset()}onChange(c){this.onChangeCallbacks.push(c)}triggerChange(){const c=JSON.stringify(this.toFormObject());if(!this.oldFormObjectString||c!==this.oldFormObjectString){this.oldFormObjectString=c;for(const A of this.onChangeCallbacks)A()}}setDefaultScope(c){this.defaultValues.set("scope",c)}setDefaultSort(c){this.defaultValues.set("sort",c)}setNSFWPolicy(c){this.updateDefaultNSFW(c)}reset(c){for(const[A,e]of this.defaultValues)c&&c!==A||(this[A]=e);this.buildActiveFilters()}load(c){void 0!==c.sort&&(this.sort=c.sort),void 0!==c.nsfw&&(this.nsfw=c.nsfw),void 0!==c.languageOneOf&&(this.languageOneOf=(0,i.g9)(c.languageOneOf)),void 0!==c.categoryOneOf&&(this.categoryOneOf=(0,i.g9)(c.categoryOneOf)),void 0!==c.scope&&(this.scope=c.scope),void 0!==c.allVideos&&(this.allVideos=(0,i.sw)(c.allVideos)),void 0!==c.live&&(this.live=c.live),void 0!==c.search&&(this.search=c.search),this.buildActiveFilters()}buildActiveFilters(){this.activeFilters=[],this.activeFilters.push({key:"nsfw",canRemove:!1,label:"Sensitive content",value:this.getNSFWValue()}),this.activeFilters.push({key:"scope",canRemove:!1,label:"Scope",value:"federated"===this.scope?"Federated":"Localas"}),this.languageOneOf&&0!==this.languageOneOf.length&&this.activeFilters.push({key:"languageOneOf",canRemove:!0,label:"Languages",value:this.languageOneOf.map(c=>c.toUpperCase()).join(", ")}),this.categoryOneOf&&0!==this.categoryOneOf.length&&this.activeFilters.push({key:"categoryOneOf",canRemove:!0,label:"Categories",value:this.categoryOneOf.join(", ")}),this.allVideos&&this.activeFilters.push({key:"allVideos",canRemove:!0,label:"All videos"}),"true"===this.live?this.activeFilters.push({key:"live",canRemove:!0,label:"Live videos"}):"false"===this.live&&this.activeFilters.push({key:"live",canRemove:!0,label:"VOD videos"}),this.activeFilters=this.activeFilters.filter(c=>!1===this.hiddenFields.includes(c.key))}getActiveFilters(){return this.activeFilters}toFormObject(){const c={};for(const[A]of this.defaultValues)c[A]=this[A];return c}toUrlObject(){const c={};for(const[A,e]of this.defaultValues)this[A]!==e&&(c[A]=this[A]);return c}toVideosAPIObject(){let c,A;return"local"===this.scope&&this.allVideos?c="all-local":"federated"===this.scope&&this.allVideos?c="all":"local"===this.scope&&(c="local"),"true"===this.live?A=!0:"false"===this.live&&(A=!1),{sort:this.sort,nsfw:this.nsfw,languageOneOf:this.languageOneOf,categoryOneOf:this.categoryOneOf,search:this.search,filter:c,isLive:A}}getNSFWDisplayLabel(){return"blur"===this.defaultNSFWPolicy?"Blurred":"Mostrada"}getNSFWValue(){return"false"===this.nsfw?"hidden":"blur"===this.defaultNSFWPolicy?"blurred":"displayed"}updateDefaultNSFW(c){this.defaultValues.set("nsfw","do_not_list"===c?"false":"both"),this.defaultNSFWPolicy=c,this.reset("nsfw")}}},69469:(Q,P,o)=>{o.d(P,{v:()=>j});var i=o(72754),t=o(42741),c=(o(359),o(62026)),A=o(54755),e=o(36226),_=o(16274),M=o(40062),T=o(29297),h=o(86552),b=o(8453),H=o(22394),w=o(49393),Y=o(92046);function W(C,y){1&C&&(t.ynx(0,23),t.SDv(1,24),t.BQk())}function z(C,y){1&C&&(t.ynx(0,25),t.SDv(1,26),t.BQk())}const I=function(C){return["/c",C]};function U(C,y){if(1&C&&t._UZ(0,"my-actor-avatar",27),2&C){const E=t.oxw();t.Q6J("title",E.channelLinkTitle)("channel",E.video.channel)("size",E.actorImageSize)("internalHref",t.VKq(4,I,E.video.byVideoChannel))}}function u(C,y){if(1&C&&t._UZ(0,"my-actor-avatar",28),2&C){const E=t.oxw();t.Q6J("title",E.channelLinkTitle)("account",E.video.account)("size",E.actorImageSize)("internalHref",t.VKq(4,I,E.video.byVideoChannel))}}function f(C,y){if(1&C&&t._UZ(0,"my-date-toggle",29),2&C){const E=t.oxw();t.Q6J("date",E.video.publishedAt)}}function O(C,y){1&C&&(t.ynx(0),t._uU(1," \u2022 "),t.BQk())}function D(C,y){if(1&C&&t._UZ(0,"my-video-views-counter",30),2&C){const E=t.oxw();t.Q6J("video",E.video)}}function L(C,y){if(1&C&&(t.TgZ(0,"a",31),t._uU(1),t.qZA()),2&C){const E=t.oxw();t.Q6J("routerLink",t.VKq(2,I,E.video.byVideoChannel)),t.xp6(1),t.hij(" ",E.video.byAccount," ")}}function k(C,y){if(1&C&&(t.TgZ(0,"a",32),t._uU(1),t.qZA()),2&C){const E=t.oxw();t.Q6J("routerLink",t.VKq(2,I,E.video.byVideoChannel)),t.xp6(1),t.hij(" ",E.video.byVideoChannel," ")}}function V(C,y){if(1&C&&(t.ynx(0),t._uU(1),t.BQk()),2&C){const E=t.oxw();t.xp6(1),t.Oqu(E.video.privacy.label)}}function x(C,y){1&C&&(t.ynx(0),t._uU(1," - "),t.BQk())}function v(C,y){if(1&C&&(t.ynx(0),t._uU(1),t.BQk()),2&C){const E=t.oxw();t.xp6(1),t.Oqu(E.getStateLabel(E.video))}}function F(C,y){if(1&C&&(t.TgZ(0,"span",37),t._uU(1),t.qZA()),2&C){const E=t.oxw(2);t.xp6(1),t.Oqu(E.video.blockedReason)}}function N(C,y){if(1&C&&(t.TgZ(0,"div",33),t.TgZ(1,"span",34),t.SDv(2,35),t.qZA(),t.YNc(3,F,2,1,"span",36),t.qZA()),2&C){const E=t.oxw();t.xp6(3),t.Q6J("ngIf",E.video.blockedReason)}}function G(C,y){1&C&&(t.TgZ(0,"div",38),t.SDv(1,39),t.qZA())}function X(C,y){if(1&C){const E=t.EpF();t.TgZ(0,"my-video-actions-dropdown",40),t.NdJ("videoRemoved",function(){return t.CHM(E),t.oxw().onVideoRemoved()})("videoBlocked",function(){return t.CHM(E),t.oxw().onVideoBlocked()})("videoUnblocked",function(){return t.CHM(E),t.oxw().onVideoUnblocked()})("videoAccountMuted",function(){return t.CHM(E),t.oxw().onVideoAccountMuted()}),t.qZA()}if(2&C){const E=t.oxw();t.Q6J("video",E.video)("displayOptions",E.videoActionsDisplayOptions)}}const q=function(C){return{"blur-filter":C}};let j=(()=>{class C{constructor(E,s,g,a,l,p){this.screenService=E,this.serverService=s,this.authService=g,this.videoPlaylistService=a,this.cd=l,this.localeId=p,this.displayOptions={date:!0,views:!0,by:!0,avatar:!1,privacyLabel:!1,privacyText:!1,state:!1,blacklistInfo:!1},this.displayVideoActions=!0,this.actorImageSize="40",this.displayAsRow=!1,this.videoLinkType="internal",this.videoBlocked=new t.vpe,this.videoUnblocked=new t.vpe,this.videoRemoved=new t.vpe,this.videoAccountMuted=new t.vpe,this.videoActionsDisplayOptions={playlist:!0,download:!1,update:!0,blacklist:!0,delete:!0,report:!0,duplicate:!0,mute:!0},this.showActions=!1,this.channelLinkTitle="",this.videoRouterLink=[]}get isVideoBlur(){return this.video.isVideoNSFWForUser(this.user,this.serverConfig)}ngOnInit(){this.serverConfig=this.serverService.getHTMLConfig(),this.buildVideoLink(),this.setUpBy(),this.channelLinkTitle="\n          " + this.video.channel.name + " (channel page)\n        ",this.screenService.isInTouchScreen()&&this.loadActions()}buildVideoLink(){if("internal"!==this.videoLinkType&&this.video.url)return"external"===this.videoLinkType?(this.videoRouterLink=null,this.videoHref=this.video.url,void(this.videoTarget="_blank")):void(this.videoRouterLink=["/search/lazy-load-video",{url:this.video.url}]);this.videoRouterLink=c.nk.buildWatchUrl(this.video)}displayOwnerAccount(){return"account"===this.ownerDisplayType}displayOwnerVideoChannel(){return"videoChannel"===this.ownerDisplayType}isUnlistedVideo(){return 2===this.video.privacy.id}isPrivateVideo(){return 3===this.video.privacy.id}getStateLabel(E){if(!E.state)return"";if(3!==E.privacy.id&&1===E.state.id)return "Publicada";if(E.scheduledUpdate){const s=new Date(E.scheduledUpdate.updateAt.toString()).toLocaleString(this.localeId);return "Publication scheduled on "+s}return 2===E.state.id&&!0===E.waitTranscoding?"En esp\xE8ra del transcodatge":2===E.state.id?"De transcodar":3===E.state.id?"D\u2019importar":""}loadActions(){this.displayVideoActions&&(this.showActions=!0),this.loadWatchLater()}onVideoBlocked(){this.videoBlocked.emit()}onVideoUnblocked(){this.videoUnblocked.emit()}onVideoRemoved(){this.videoRemoved.emit()}onVideoAccountMuted(){this.videoAccountMuted.emit()}isUserLoggedIn(){return this.authService.isLoggedIn()}onWatchLaterClick(E){!0===E?this.removeFromWatchLater():this.addToWatchLater(),this.inWatchLaterPlaylist=!E}addToWatchLater(){this.videoPlaylistService.addVideoInPlaylist(this.watchLaterPlaylist.id,{videoId:this.video.id}).subscribe(s=>{this.watchLaterPlaylist.playlistElementId=s.videoPlaylistElement.id})}removeFromWatchLater(){this.videoPlaylistService.removeVideoFromPlaylist(this.watchLaterPlaylist.id,this.watchLaterPlaylist.playlistElementId,this.video.id).subscribe(E=>{})}isWatchLaterPlaylistDisplayed(){return this.displayVideoActions&&this.isUserLoggedIn()&&void 0!==this.inWatchLaterPlaylist}getClasses(){return{"display-as-row":this.displayAsRow}}setUpBy(){const E=this.video.account.name;this.ownerDisplayType=this.video.channel.displayName===`Default ${E} channel`||this.video.channel.displayName===`Main ${E} channel`||this.video.channel.name.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/)?"account":"videoChannel"}loadWatchLater(){!this.isUserLoggedIn()||void 0!==this.inWatchLaterPlaylist||(this.authService.userInformationLoaded.pipe((0,i.w)(()=>this.videoPlaylistService.listenToVideoPlaylistChange(this.video.id))).subscribe(E=>{const s=this.authService.getUser().specialPlaylists.find(a=>2===a.type),g=E.find(a=>a.playlistId===s.id);this.inWatchLaterPlaylist=!1,this.watchLaterPlaylist={id:s.id},g&&(this.inWatchLaterPlaylist=!0,this.watchLaterPlaylist.playlistElementId=g.playlistElementId),this.cd.markForCheck()}),this.videoPlaylistService.runPlaylistCheck(this.video.id))}}return C.\u0275fac=function(E){return new(E||C)(t.Y36(A.H2),t.Y36(A.NG),t.Y36(A.e8),t.Y36(e.Qq),t.Y36(t.sBO),t.Y36(t.soG))},C.\u0275cmp=t.Xpm({type:C,selectors:[["my-video-miniature"]],inputs:{user:"user",video:"video",displayOptions:"displayOptions",displayVideoActions:"displayVideoActions",actorImageSize:"actorImageSize",displayAsRow:"displayAsRow",videoLinkType:"videoLinkType"},outputs:{videoBlocked:"videoBlocked",videoUnblocked:"videoUnblocked",videoRemoved:"videoRemoved",videoAccountMuted:"videoAccountMuted"},decls:27,vars:32,consts:function(){let y,E,s,g;return y="Pas listada",E="Privada",s="Blocked",g="\n        Sensible\n      ",[[1,"video-miniature",3,"ngClass","mouseenter"],[3,"video","nsfw","videoRouterLink","videoHref","videoTarget","displayWatchLaterPlaylist","inWatchLaterPlaylist","watchLaterClick"],["ngProjectAs","label-warning",5,["label-warning"],4,"ngIf"],["ngProjectAs","label-danger",5,["label-danger"],4,"ngIf"],[1,"video-bottom"],[1,"video-miniature-information"],[1,"d-flex","video-miniature-meta"],[3,"title","channel","size","internalHref",4,"ngIf"],[3,"title","account","size","internalHref",4,"ngIf"],[1,"w-100","d-flex","flex-column"],["tabindex","-1",1,"video-miniature-name",3,"internalLink","href","target","title","ngClass"],[1,"video-miniature-created-at-views"],[3,"date",4,"ngIf"],[1,"views",3,"title"],[4,"ngIf"],[3,"video",4,"ngIf"],["tabindex","-1","class","video-miniature-account",3,"routerLink",4,"ngIf"],["tabindex","-1","class","video-miniature-channel",3,"routerLink",4,"ngIf"],[1,"video-info-privacy"],["class","video-info-blocked",4,"ngIf"],["class","video-info-nsfw",4,"ngIf"],[1,"video-actions"],["placement","bottom-left bottom-right left auto",3,"video","displayOptions","videoRemoved","videoBlocked","videoUnblocked","videoAccountMuted",4,"ngIf"],["ngProjectAs","label-warning",5,["label-warning"]],y,["ngProjectAs","label-danger",5,["label-danger"]],E,[3,"title","channel","size","internalHref"],[3,"title","account","size","internalHref"],[3,"date"],[3,"video"],["tabindex","-1",1,"video-miniature-account",3,"routerLink"],["tabindex","-1",1,"video-miniature-channel",3,"routerLink"],[1,"video-info-blocked"],[1,"blocked-label"],s,["class","blocked-reason",4,"ngIf"],[1,"blocked-reason"],[1,"video-info-nsfw"],g,["placement","bottom-left bottom-right left auto",3,"video","displayOptions","videoRemoved","videoBlocked","videoUnblocked","videoAccountMuted"]]},template:function(E,s){1&E&&(t.TgZ(0,"div",0),t.NdJ("mouseenter",function(){return s.loadActions()}),t.TgZ(1,"my-video-thumbnail",1),t.NdJ("watchLaterClick",function(a){return s.onWatchLaterClick(a)}),t.YNc(2,W,2,0,"ng-container",2),t.YNc(3,z,2,0,"ng-container",3),t.qZA(),t.TgZ(4,"div",4),t.TgZ(5,"div",5),t.TgZ(6,"div",6),t.YNc(7,U,1,6,"my-actor-avatar",7),t.YNc(8,u,1,6,"my-actor-avatar",8),t.TgZ(9,"div",9),t.TgZ(10,"my-link",10),t._uU(11),t.qZA(),t.TgZ(12,"span",11),t.YNc(13,f,1,1,"my-date-toggle",12),t.TgZ(14,"span",13),t.YNc(15,O,2,0,"ng-container",14),t.YNc(16,D,1,1,"my-video-views-counter",15),t.qZA(),t.qZA(),t.YNc(17,L,2,4,"a",16),t.YNc(18,k,2,4,"a",17),t.TgZ(19,"div",18),t.YNc(20,V,2,1,"ng-container",14),t.YNc(21,x,2,0,"ng-container",14),t.YNc(22,v,2,1,"ng-container",14),t.qZA(),t.qZA(),t.qZA(),t.YNc(23,N,4,1,"div",19),t.YNc(24,G,2,0,"div",20),t.qZA(),t.TgZ(25,"div",21),t.YNc(26,X,1,2,"my-video-actions-dropdown",22),t.qZA(),t.qZA(),t.qZA()),2&E&&(t.Q6J("ngClass",s.getClasses()),t.xp6(1),t.Q6J("video",s.video)("nsfw",s.isVideoBlur)("videoRouterLink",s.videoRouterLink)("videoHref",s.videoHref)("videoTarget",s.videoTarget)("displayWatchLaterPlaylist",s.isWatchLaterPlaylistDisplayed())("inWatchLaterPlaylist",s.inWatchLaterPlaylist),t.xp6(1),t.Q6J("ngIf",s.displayOptions.privacyLabel&&s.isUnlistedVideo()),t.xp6(1),t.Q6J("ngIf",s.displayOptions.privacyLabel&&s.isPrivateVideo()),t.xp6(4),t.Q6J("ngIf",s.displayOptions.avatar&&s.displayOwnerVideoChannel()&&!s.displayAsRow),t.xp6(1),t.Q6J("ngIf",s.displayOptions.avatar&&s.displayOwnerAccount()&&!s.displayAsRow),t.xp6(2),t.Q6J("internalLink",s.videoRouterLink)("href",s.videoHref)("target",s.videoTarget)("title",s.video.name)("ngClass",t.VKq(30,q,s.isVideoBlur)),t.xp6(1),t.hij(" ",s.video.name," "),t.xp6(2),t.Q6J("ngIf",s.displayOptions.date),t.xp6(1),t.Q6J("title",s.video.getExactNumberOfViews()),t.xp6(1),t.Q6J("ngIf",s.displayOptions.date&&s.displayOptions.views),t.xp6(1),t.Q6J("ngIf",s.displayOptions.views),t.xp6(1),t.Q6J("ngIf",s.displayOptions.by&&s.displayOwnerAccount()),t.xp6(1),t.Q6J("ngIf",s.displayOptions.by&&s.displayOwnerVideoChannel()),t.xp6(2),t.Q6J("ngIf",s.displayOptions.privacyText),t.xp6(1),t.Q6J("ngIf",s.displayOptions.privacyText&&s.displayOptions.state&&s.getStateLabel(s.video)),t.xp6(1),t.Q6J("ngIf",s.displayOptions.state),t.xp6(1),t.Q6J("ngIf",s.displayOptions.blacklistInfo&&s.video.blacklisted),t.xp6(1),t.Q6J("ngIf",s.displayOptions.nsfw&&s.video.nsfw),t.xp6(2),t.Q6J("ngIf",s.showActions))},directives:[_.mk,M.W,_.O5,T.N,h.b,b.J,H.M,w.yS,Y.i],styles:['.video-miniature-name[_ngcontent-%COMP%]{display:block;display:-webkit-box;-webkit-line-clamp:2;font-size:1.1em;line-height:1.1em;overflow:hidden;text-overflow:ellipsis;max-height:2.2em;word-break:break-word;word-wrap:break-word;overflow-wrap:break-word;transition:color .2s;font-weight:600;color:var(--mainForegroundColor)}.video-miniature-name[_ngcontent-%COMP%]:hover{text-decoration:none}.video-miniature-name.blur-filter[_ngcontent-%COMP%]{filter:blur(3px)}@supports (padding-inline-start: 4px){.video-miniature-name.blur-filter[_ngcontent-%COMP%]{padding-inline-start:4px}}@supports not (padding-inline-start: 4px){.video-miniature-name.blur-filter[_ngcontent-%COMP%]{padding-left:4px}}.video-miniature-information[_ngcontent-%COMP%]{width:calc(100% - 40px)}my-actor-avatar[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:0}@supports (margin-inline-start: 0){my-actor-avatar[_ngcontent-%COMP%]{margin-inline-start:0}}@supports not (margin-inline-start: 0){my-actor-avatar[_ngcontent-%COMP%]{margin-left:0}}@supports (margin-inline-end: 10px){my-actor-avatar[_ngcontent-%COMP%]{margin-inline-end:10px}}@supports not (margin-inline-end: 10px){my-actor-avatar[_ngcontent-%COMP%]{margin-right:10px}}.video-miniature-created-at-views[_ngcontent-%COMP%]{font-size:13px}.video-miniature-account[_ngcontent-%COMP%], .video-miniature-channel[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;font-size:13px;color:var(--greyForegroundColor)}.video-miniature-account[_ngcontent-%COMP%]:hover, .video-miniature-account[_ngcontent-%COMP%]:focus, .video-miniature-account[_ngcontent-%COMP%]:active, .video-miniature-channel[_ngcontent-%COMP%]:hover, .video-miniature-channel[_ngcontent-%COMP%]:focus, .video-miniature-channel[_ngcontent-%COMP%]:active{text-decoration:none!important;outline:none!important}.video-miniature-account[_ngcontent-%COMP%]:hover, .video-miniature-channel[_ngcontent-%COMP%]:hover{color:#303030}.video-info-privacy[_ngcontent-%COMP%], .video-info-blocked[_ngcontent-%COMP%]   .blocked-label[_ngcontent-%COMP%], .video-info-nsfw[_ngcontent-%COMP%]{font-weight:600}.video-info-blocked[_ngcontent-%COMP%]{color:red}.video-info-blocked[_ngcontent-%COMP%]   .blocked-reason[_ngcontent-%COMP%]:before{content:" - "}.video-info-nsfw[_ngcontent-%COMP%]{color:red}.video-actions[_ngcontent-%COMP%]{width:40px;height:30px}.video-actions[_ngcontent-%COMP%]     .dropdown-root:not(.show){opacity:0}.video-actions[_ngcontent-%COMP%]     .playlist-dropdown.show+my-action-dropdown .dropdown-root{opacity:1}.video-actions[_ngcontent-%COMP%]     .more-icon{opacity:.6}.video-actions[_ngcontent-%COMP%]     .more-icon:hover{opacity:1}.video-miniature[_ngcontent-%COMP%]:hover     .video-thumbnail-actions-overlay, .video-miniature[_ngcontent-%COMP%]:hover   .video-actions[_ngcontent-%COMP%]     .dropdown-root{opacity:1!important}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row){display:flex;flex-direction:column;padding-bottom:15px;width:100%}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   my-video-thumbnail[_ngcontent-%COMP%]{position:relative;height:0;width:100%;padding-top:56.25%}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   my-video-thumbnail[_ngcontent-%COMP%]     .video-thumbnail{position:absolute;width:100%;height:100%;top:0}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   .video-bottom[_ngcontent-%COMP%]{display:flex;width:100%;min-width:1px}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   .video-miniature-name[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:5px}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   .video-miniature-created-at-views[_ngcontent-%COMP%]{display:block}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   .video-actions[_ngcontent-%COMP%]{margin-top:3px}@media screen and (max-width: 800px){.video-miniature[_ngcontent-%COMP%]:not(.display-as-row){width:100%;margin-bottom:25px}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   .video-miniature-information[_ngcontent-%COMP%]{margin:0 10px;width:100%;text-align:left}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   .video-actions[_ngcontent-%COMP%]{margin:0;top:-3px}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)   .video-actions[_ngcontent-%COMP%]     .dropdown-root{opacity:1!important}.video-miniature[_ngcontent-%COMP%]:not(.display-as-row)     .video-thumbnail{border-radius:0}}.video-miniature.display-as-row[_ngcontent-%COMP%]{--rowThumbnailWidth: 280px;--rowThumbnailHeight: 153px;display:flex;flex-direction:row}.video-miniature.display-as-row[_ngcontent-%COMP%]   .video-bottom[_ngcontent-%COMP%]{display:flex;min-width:1px}.video-miniature.display-as-row[_ngcontent-%COMP%]   .channel-avatar[_ngcontent-%COMP%]{display:none}.video-miniature.display-as-row[_ngcontent-%COMP%]   my-video-thumbnail[_ngcontent-%COMP%]{min-width:var(--rowThumbnailWidth);max-width:var(--rowThumbnailWidth);height:var(--rowThumbnailHeight)}@supports (margin-inline-end: 10px){.video-miniature.display-as-row[_ngcontent-%COMP%]   my-video-thumbnail[_ngcontent-%COMP%]{margin-inline-end:10px}}@supports not (margin-inline-end: 10px){.video-miniature.display-as-row[_ngcontent-%COMP%]   my-video-thumbnail[_ngcontent-%COMP%]{margin-right:10px}}.video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-name[_ngcontent-%COMP%]{display:block;display:-webkit-box;-webkit-line-clamp:2;font-size:1.3em;line-height:1.3em;overflow:hidden;text-overflow:ellipsis;max-height:2.6em}.video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-created-at-views[_ngcontent-%COMP%], .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-account[_ngcontent-%COMP%], .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-channel[_ngcontent-%COMP%]{font-size:14px}.video-miniature.display-as-row[_ngcontent-%COMP%]   .video-actions[_ngcontent-%COMP%]{margin-top:-3px}@media screen and (max-width: 1040px){.main-col:not(.expanded)[_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]{--rowThumbnailWidth: 201px;--rowThumbnailHeight: 114px}}@media screen and (max-width: 800px){.main-col.expanded[_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]{--rowThumbnailWidth: 201px;--rowThumbnailHeight: 114px}}@media screen and (max-width: 740px){.main-col:not(.expanded)[_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]{--rowThumbnailWidth: 125px;--rowThumbnailHeight: 71px}.main-col:not(.expanded)[_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-name[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-name[_ngcontent-%COMP%]{font-size:14px}.main-col:not(.expanded)[_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-created-at-views[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-created-at-views[_ngcontent-%COMP%], .main-col:not(.expanded)[_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-account[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-account[_ngcontent-%COMP%], .main-col:not(.expanded)[_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-channel[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-channel[_ngcontent-%COMP%]{font-size:12px}}@media screen and (max-width: 500px){.main-col.expanded[_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]{--rowThumbnailWidth: 125px;--rowThumbnailHeight: 71px}.main-col.expanded[_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-name[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-name[_ngcontent-%COMP%]{font-size:14px}.main-col.expanded[_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-created-at-views[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-created-at-views[_ngcontent-%COMP%], .main-col.expanded[_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-account[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-account[_ngcontent-%COMP%], .main-col.expanded[_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-channel[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .video-miniature.display-as-row[_ngcontent-%COMP%]   .video-miniature-channel[_ngcontent-%COMP%]{font-size:12px}}'],changeDetection:0}),C})()},75585:(Q,P,o)=>{o.d(P,{d:()=>p});var i=o(57115),n=o(64033),c=o(59437),A=o(91531),e=o(72754),_=o(42741),M=o(54175),h=(o(359),o(98803)),b=o(54755),H=o(49393),w=o(16274),Y=o(66717),W=o(76476),z=o(34261),I=o(64990),U=o(31470),u=o(69469);function f(r,S){if(1&r&&(_.TgZ(0,"h1",10),_._uU(1),_.qZA()),2&r){const d=_.oxw();_.Q6J("ngbTooltip",d.titleTooltip),_.xp6(1),_.hij(" ",d.title," ")}}const O=function(r){return{"no-title":r}};function D(r,S){if(1&r&&(_.TgZ(0,"div",11),_.ynx(1),_.SDv(2,12),_.BQk(),_._UZ(3,"my-feed",13),_.qZA()),2&r){const d=_.oxw();_.Q6J("ngClass",_.VKq(3,O,!d.displayTitle)),_.xp6(2),_.pQV(d.title),_.QtT(2),_.xp6(1),_.Q6J("syndicationItems",d.syndicationItems)}}function L(r,S){1&r&&_.GkF(0)}const k=function(r){return{$implicit:r}};function V(r,S){if(1&r&&(_.TgZ(0,"a",18),_.YNc(1,L,1,0,"ng-container",19),_.qZA()),2&r){const d=_.oxw().$implicit,m=_.MAs(5);_.Q6J("routerLink",d.routerLink),_.xp6(1),_.Q6J("ngTemplateOutlet",m)("ngTemplateOutletContext",_.VKq(3,k,d))}}function x(r,S){1&r&&_.GkF(0)}function v(r,S){if(1&r){const d=_.EpF();_.TgZ(0,"a",20),_.NdJ("click",function(R){return _.CHM(d),_.oxw().$implicit.click(R)})("key.enter",function(R){return _.CHM(d),_.oxw().$implicit.click(R)}),_.YNc(1,x,1,0,"ng-container",19),_.qZA()}if(2&r){const d=_.oxw().$implicit,m=_.MAs(5);_.xp6(1),_.Q6J("ngTemplateOutlet",m)("ngTemplateOutletContext",_.VKq(2,k,d))}}function F(r,S){1&r&&_.GkF(0)}function N(r,S){if(1&r){const d=_.EpF();_.TgZ(0,"a",21),_.NdJ("click",function(R){return _.CHM(d),_.oxw().$implicit.click(R)})("key.enter",function(R){return _.CHM(d),_.oxw().$implicit.click(R)}),_.YNc(1,F,1,0,"ng-container",19),_.qZA()}if(2&r){const d=_.oxw().$implicit,m=_.MAs(5);_.Q6J("href",d.href,_.LSH),_.xp6(1),_.Q6J("ngTemplateOutlet",m)("ngTemplateOutletContext",_.VKq(3,k,d))}}function G(r,S){if(1&r&&_._UZ(0,"my-button",24),2&r){const d=_.oxw().$implicit;_.Q6J("icon",d.iconName)("label",d.label)}}function X(r,S){if(1&r&&_._UZ(0,"my-button",25),2&r){const d=_.oxw().$implicit;_.Q6J("icon",d.iconName)("ngbTooltip",d.label)}}function q(r,S){if(1&r&&(_.YNc(0,G,1,2,"my-button",22),_.YNc(1,X,1,2,"my-button",23)),2&r){const d=S.$implicit;_.Q6J("ngIf",!d.justIcon),_.xp6(1),_.Q6J("ngIf",d.justIcon)}}function j(r,S){if(1&r&&(_.ynx(0),_.YNc(1,V,2,5,"a",14),_.YNc(2,v,2,4,"a",15),_.YNc(3,N,2,5,"a",16),_.YNc(4,q,2,2,"ng-template",null,17,_.W1O),_.BQk()),2&r){const d=S.$implicit;_.xp6(1),_.Q6J("ngIf",d.routerLink),_.xp6(1),_.Q6J("ngIf",!d.routerLink&&!d.href&&d.click),_.xp6(1),_.Q6J("ngIf",!d.routerLink&&d.href&&d.click)}}function C(r,S){if(1&r){const d=_.EpF();_.TgZ(0,"my-video-filters-header",26),_.NdJ("filtersChanged",function(){return _.CHM(d),_.oxw().onFiltersChanged(!0)}),_.qZA()}if(2&r){const d=_.oxw();_.Q6J("displayModerationBlock",d.displayModerationBlock)("hideScope",d.hideScopeFilter)("filters",d.filters)}}function y(r,S){1&r&&(_.TgZ(0,"div",27),_.SDv(1,28),_.qZA())}function E(r,S){if(1&r&&(_.TgZ(0,"h2",32),_._uU(1),_.qZA()),2&r){const d=_.oxw().$implicit,m=_.oxw();_.xp6(1),_.hij(" ",m.getCurrentGroupedDateLabel(d)," ")}}function s(r,S){if(1&r){const d=_.EpF();_.ynx(0),_.YNc(1,E,2,1,"h2",29),_.TgZ(2,"div",30),_.TgZ(3,"my-video-miniature",31),_.NdJ("videoBlocked",function(){const $=_.CHM(d).$implicit;return _.oxw().removeVideoFromArray($)})("videoRemoved",function(){const $=_.CHM(d).$implicit;return _.oxw().removeVideoFromArray($)}),_.qZA(),_.qZA(),_.BQk()}if(2&r){const d=S.$implicit,m=_.oxw();_.xp6(1),_.Q6J("ngIf",m.getCurrentGroupedDateLabel(d)),_.xp6(2),_.Q6J("video",d)("user",m.userMiniature)("displayAsRow",m.displayAsRow)("displayVideoActions",m.displayVideoActions)("displayOptions",m.displayOptions)}}const g=function(r){return{"display-as-row":r}},a=i("peertube:videos:VideosListComponent");var l=(()=>{return(r=l||(l={}))[r.UNKNOWN=0]="UNKNOWN",r[r.TODAY=1]="TODAY",r[r.YESTERDAY=2]="YESTERDAY",r[r.THIS_WEEK=3]="THIS_WEEK",r[r.THIS_MONTH=4]="THIS_MONTH",r[r.LAST_MONTH=5]="LAST_MONTH",r[r.OLDER=6]="OLDER",l;var r})();let p=(()=>{class r{constructor(d,m,R,$,K,J){this.notifier=d,this.authService=m,this.userService=R,this.route=$,this.screenService=K,this.peertubeRouter=J,this.displayTitle=!0,this.defaultScope="federated",this.displayFilters=!1,this.displayModerationBlock=!1,this.loadUserVideoPreferences=!1,this.displayAsRow=!1,this.displayVideoActions=!0,this.groupByDate=!1,this.headerActions=[],this.hideScopeFilter=!1,this.displayOptions={date:!0,views:!0,by:!0,avatar:!1,privacyLabel:!0,privacyText:!1,state:!1,blacklistInfo:!1},this.disabled=!1,this.filtersChanged=new _.vpe,this.videos=[],this.onDataSubject=new n.x,this.hasDoneFirstQuery=!1,this.pagination={currentPage:1,itemsPerPage:25},this.groupedDates={}}ngOnInit(){this.filters=new h.P(this.defaultSort,this.defaultScope,this.hideScopeFilter?["scope"]:[]),this.filters.load(Object.assign(Object.assign({},this.route.snapshot.queryParams),{scope:this.defaultScope})),this.groupedDateLabels={[l.UNKNOWN]:null,[l.TODAY]:"U\xE8i",[l.YESTERDAY]:"Yesterday",[l.THIS_WEEK]:"This week",[l.THIS_MONTH]:"This month",[l.LAST_MONTH]:"Last month",[l.OLDER]:"Older"},this.resizeSub=(0,c.R)(window,"resize").pipe((0,A.b)(500)).subscribe(()=>this.calcPageSizes()),this.calcPageSizes(),this.userService.getAnonymousOrLoggedUser().subscribe(m=>{this.userMiniature=m,this.loadUserVideoPreferences&&this.loadUserSettings(m),this.scheduleOnFiltersChanged(!1),this.subscribeToAnonymousUpdate(),this.subscribeToSearchChange()}),this.screenService.isInMobileView()&&(this.displayOptions.avatar=!0)}ngOnDestroy(){this.resizeSub&&this.resizeSub.unsubscribe(),this.routeSub&&this.routeSub.unsubscribe(),this.userSub&&this.userSub.unsubscribe()}ngOnChanges(d){if(!this.filters)return;let m=!1;if(d.defaultScope&&(m=!0,this.filters.setDefaultScope(this.defaultScope)),d.defaultSort&&(m=!0,this.filters.setDefaultSort(this.defaultSort)),!m)return;const R=this.hasBeenCustomizedByUser();R||(this.loadUserVideoPreferences&&this.loadUserSettings(this.userMiniature),this.filters.reset("scope"),this.filters.reset("sort")),this.scheduleOnFiltersChanged(R)}videoById(d,m){return m.id}onNearOfBottom(){this.disabled||void 0!==this.lastQueryLength&&this.lastQueryLength<this.pagination.itemsPerPage||(this.pagination.currentPage+=1,this.loadMoreVideos())}loadMoreVideos(d=!1){this.getVideosObservableFunction(this.pagination,this.filters).subscribe({next:({data:m})=>{this.hasDoneFirstQuery=!0,this.lastQueryLength=m.length,d&&(this.videos=[]),this.videos=this.videos.concat(m),this.groupByDate&&this.buildGroupedDateLabels(),this.onDataSubject.next(m)},error:m=>{const R="Cannot load more videos. Try again later.";console.error(R,{err:m}),this.notifier.error(R)}})}reloadVideos(){this.pagination.currentPage=1,this.loadMoreVideos(!0)}removeVideoFromArray(d){this.videos=this.videos.filter(m=>m.id!==d.id)}buildGroupedDateLabels(){let d=l.UNKNOWN;const m=[{value:l.TODAY,validator:R=>(0,M.zk)(R)},{value:l.YESTERDAY,validator:R=>(0,M.gO)(R)},{value:l.THIS_WEEK,validator:R=>(0,M.zy)(R)},{value:l.THIS_MONTH,validator:R=>(0,M.UG)(R)},{value:l.LAST_MONTH,validator:R=>(0,M.Is)(R)},{value:l.OLDER,validator:()=>!0}];for(const R of this.videos){const $=R.publishedAt;for(let K=0;K<m.length;K++){const J=m[K];if(d<=J.value&&J.validator($)){d!==J.value&&(d=J.value,this.groupedDates[R.id]=d);break}}}}getCurrentGroupedDateLabel(d){if(!1!==this.groupByDate)return this.groupedDateLabels[this.groupedDates[d.id]]}scheduleOnFiltersChanged(d){this.videos=[],setTimeout(()=>this.onFiltersChanged(d))}onFiltersChanged(d){a("Running on filters changed"),this.updateUrl(d),this.filters.triggerChange(),this.reloadSyndicationItems(),this.reloadVideos()}enableAllFilterIfPossible(){!this.authService.isLoggedIn()||this.authService.userInformationLoaded.subscribe(()=>{const d=this.authService.getUser();this.displayModerationBlock=d.hasRight(20)})}calcPageSizes(){this.screenService.isInMobileView()&&(this.pagination.itemsPerPage=5)}loadUserSettings(d){this.filters.setNSFWPolicy(d.nsfwPolicy),this.hasBeenCustomizedByUser()||this.filters.load({languageOneOf:d.videoLanguages})}reloadSyndicationItems(){Promise.resolve(this.getSyndicationItemsFunction(this.filters)).then(d=>{this.syndicationItems=d&&0!==d.length?d:void 0}).catch(d=>console.error("Cannot get syndication items.",d))}updateUrl(d){const m=this.filters.toUrlObject(),R=d||this.hasBeenCustomizedByUser()?Object.assign(Object.assign({},m),{c:d}):m;a("Will inject %O in URL query",R);const $=this.baseRouteBuilderFunction?this.baseRouteBuilderFunction(this.filters):[],K=window.location.pathname;(0!==$.length&&"/"!==K&&0!==$.length&&K!==$.join("/")||0!==Object.keys(m).length||d)&&this.peertubeRouter.silentNavigate($,R),this.filtersChanged.emit(this.filters)}hasBeenCustomizedByUser(){return"true"===this.route.snapshot.queryParams.c}subscribeToAnonymousUpdate(){this.userSub=this.userService.listenAnonymousUpdate().pipe((0,e.w)(()=>this.userService.getAnonymousOrLoggedUser())).subscribe(d=>{this.loadUserVideoPreferences&&this.loadUserSettings(d),this.hasDoneFirstQuery&&this.reloadVideos()})}subscribeToSearchChange(){this.routeSub=this.route.queryParams.subscribe(d=>{!d.search||(this.filters.load({search:d.search}),this.onFiltersChanged(!0))})}}return r.\u0275fac=function(d){return new(d||r)(_.Y36(b.d4),_.Y36(b.e8),_.Y36(b.KD),_.Y36(H.gz),_.Y36(b.H2),_.Y36(b.T1))},r.\u0275cmp=_.Xpm({type:r,selectors:[["my-videos-list"]],inputs:{getVideosObservableFunction:"getVideosObservableFunction",getSyndicationItemsFunction:"getSyndicationItemsFunction",baseRouteBuilderFunction:"baseRouteBuilderFunction",title:"title",titleTooltip:"titleTooltip",displayTitle:"displayTitle",defaultSort:"defaultSort",defaultScope:"defaultScope",displayFilters:"displayFilters",displayModerationBlock:"displayModerationBlock",loadUserVideoPreferences:"loadUserVideoPreferences",displayAsRow:"displayAsRow",displayVideoActions:"displayVideoActions",groupByDate:"groupByDate",headerActions:"headerActions",hideScopeFilter:"hideScopeFilter",displayOptions:"displayOptions",disabled:"disabled"},outputs:{filtersChanged:"filtersChanged"},features:[_.TTD],decls:10,vars:13,consts:function(){let S,d;return S="Subscribe to RSS feed \"" + "\ufffd0\ufffd" + "\"",d="No results.",[[1,"margin-content"],[1,"videos-header"],["class","title","placement","bottom","container","body",3,"ngbTooltip",4,"ngIf"],["class","title-subscription",3,"ngClass",4,"ngIf"],[1,"action-block"],[4,"ngFor","ngForOf"],[3,"displayModerationBlock","hideScope","filters","filtersChanged",4,"ngIf"],["class","no-results",4,"ngIf"],["myInfiniteScroller","",1,"videos",3,"dataObservable","setAngularState","parentDisabled","ngClass","nearOfBottom"],[4,"ngFor","ngForOf","ngForTrackBy"],["placement","bottom","container","body",1,"title",3,"ngbTooltip"],[1,"title-subscription",3,"ngClass"],S,[3,"syndicationItems"],["class","ml-2","routerLinkActive","active",3,"routerLink",4,"ngIf"],["class","ml-2",3,"click","key.enter",4,"ngIf"],["class","ml-2",3,"href","click","key.enter",4,"ngIf"],["actionContent",""],["routerLinkActive","active",1,"ml-2",3,"routerLink"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"ml-2",3,"click","key.enter"],[1,"ml-2",3,"href","click","key.enter"],[3,"icon","label",4,"ngIf"],[3,"icon","ngbTooltip",4,"ngIf"],[3,"icon","label"],[3,"icon","ngbTooltip"],[3,"displayModerationBlock","hideScope","filters","filtersChanged"],[1,"no-results"],d,["class","date-title",4,"ngIf"],[1,"video-wrapper"],[3,"video","user","displayAsRow","displayVideoActions","displayOptions","videoBlocked","videoRemoved"],[1,"date-title"]]},template:function(d,m){1&d&&(_.TgZ(0,"div",0),_.TgZ(1,"div",1),_.YNc(2,f,2,2,"h1",2),_.YNc(3,D,4,5,"div",3),_.TgZ(4,"div",4),_.YNc(5,j,6,3,"ng-container",5),_.qZA(),_.qZA(),_.YNc(6,C,1,3,"my-video-filters-header",6),_.YNc(7,y,2,0,"div",7),_.TgZ(8,"div",8),_.NdJ("nearOfBottom",function(){return m.onNearOfBottom()}),_.YNc(9,s,4,6,"ng-container",9),_.qZA(),_.qZA()),2&d&&(_.xp6(2),_.Q6J("ngIf",m.displayTitle),_.xp6(1),_.Q6J("ngIf",m.syndicationItems),_.xp6(2),_.Q6J("ngForOf",m.headerActions),_.xp6(1),_.Q6J("ngIf",m.displayFilters),_.xp6(1),_.Q6J("ngIf",m.hasDoneFirstQuery&&0===m.videos.length),_.xp6(1),_.Q6J("dataObservable",m.onDataSubject.asObservable())("setAngularState",!0)("parentDisabled",m.disabled)("ngClass",_.VKq(11,g,m.displayAsRow)),_.xp6(1),_.Q6J("ngForOf",m.videos)("ngForTrackBy",m.videoById))},directives:[w.O5,w.sg,Y.A,w.mk,W._L,z.e,H.yS,H.Od,w.tP,I.r,U.Y,u.v],styles:[".videos-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto 1fr auto;margin-bottom:30px}.videos-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .videos-header[_ngcontent-%COMP%]   .title-subscription[_ngcontent-%COMP%]{grid-column:1}.videos-header[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{font-size:18px;color:var(--mainForegroundColor);display:inline-block;font-weight:600;margin-top:30px;margin-bottom:0}.videos-header[_ngcontent-%COMP%]   .title-subscription[_ngcontent-%COMP%]{grid-row:2;font-size:14px;color:var(--greyForegroundColor)}.videos-header[_ngcontent-%COMP%]   .title-subscription.no-title[_ngcontent-%COMP%]{margin-top:10px}.videos-header[_ngcontent-%COMP%]   .action-block[_ngcontent-%COMP%]{grid-column:3;grid-row:1/3;margin-top:30px}.videos-header[_ngcontent-%COMP%]   my-feed[_ngcontent-%COMP%]{display:inline-block;width:16px;color:var(--mainColor);position:relative;top:-2px}@supports (margin-inline-start: 5px){.videos-header[_ngcontent-%COMP%]   my-feed[_ngcontent-%COMP%]{margin-inline-start:5px}}@supports not (margin-inline-start: 5px){.videos-header[_ngcontent-%COMP%]   my-feed[_ngcontent-%COMP%]{margin-left:5px}}.date-title[_ngcontent-%COMP%]{font-size:16px;font-weight:600;margin-bottom:20px;grid-column:1/-1}.date-title[_ngcontent-%COMP%]:not(:first-child){margin-top:.5rem;padding-top:20px;border-top:1px solid rgba(0,0,0,.1)}.margin-content[_ngcontent-%COMP%]{--gridVideosMiniatureMargins: var(--videosHorizontalMarginContent)}@supports (margin-inline-start: var(--gridVideosMiniatureMargins) !important){.margin-content[_ngcontent-%COMP%]{margin-inline-start:var(--gridVideosMiniatureMargins)!important}}@supports not (margin-inline-start: var(--gridVideosMiniatureMargins) !important){.margin-content[_ngcontent-%COMP%]{margin-left:var(--gridVideosMiniatureMargins)!important}}@supports (margin-inline-end: var(--gridVideosMiniatureMargins) !important){.margin-content[_ngcontent-%COMP%]{margin-inline-end:var(--gridVideosMiniatureMargins)!important}}@supports not (margin-inline-end: var(--gridVideosMiniatureMargins) !important){.margin-content[_ngcontent-%COMP%]{margin-right:var(--gridVideosMiniatureMargins)!important}}@media screen and (max-width: 500px){.margin-content[_ngcontent-%COMP%]{--gridVideosMiniatureMargins: 0;width:auto}}@media screen and (min-width: 500px){.margin-content[_ngcontent-%COMP%]   .videos[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .playlists[_ngcontent-%COMP%]{--miniatureMinWidth: 255px;--miniatureMaxWidth: 280px;display:grid;grid-column-gap:30px;column-gap:30px;grid-template-columns:repeat(auto-fill,minmax(var(--miniatureMinWidth),1fr))}.margin-content[_ngcontent-%COMP%]   .videos[_ngcontent-%COMP%]   .video-wrapper[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .videos[_ngcontent-%COMP%]   .playlist-wrapper[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .playlists[_ngcontent-%COMP%]   .video-wrapper[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .playlists[_ngcontent-%COMP%]   .playlist-wrapper[_ngcontent-%COMP%]{margin:0 auto;width:100%}.margin-content[_ngcontent-%COMP%]   .videos[_ngcontent-%COMP%]   .video-wrapper[_ngcontent-%COMP%]   my-video-miniature[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .videos[_ngcontent-%COMP%]   .video-wrapper[_ngcontent-%COMP%]   my-video-playlist-miniature[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .videos[_ngcontent-%COMP%]   .playlist-wrapper[_ngcontent-%COMP%]   my-video-miniature[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .videos[_ngcontent-%COMP%]   .playlist-wrapper[_ngcontent-%COMP%]   my-video-playlist-miniature[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .playlists[_ngcontent-%COMP%]   .video-wrapper[_ngcontent-%COMP%]   my-video-miniature[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .playlists[_ngcontent-%COMP%]   .video-wrapper[_ngcontent-%COMP%]   my-video-playlist-miniature[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .playlists[_ngcontent-%COMP%]   .playlist-wrapper[_ngcontent-%COMP%]   my-video-miniature[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .playlists[_ngcontent-%COMP%]   .playlist-wrapper[_ngcontent-%COMP%]   my-video-playlist-miniature[_ngcontent-%COMP%]{display:block;min-width:var(--miniatureMinWidth);max-width:var(--miniatureMaxWidth)}}@media screen and (min-width: 500px) and (min-width: breakpoint(xm)){.margin-content[_ngcontent-%COMP%]   .videos[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .playlists[_ngcontent-%COMP%]{grid-column-gap:15px;column-gap:15px}}@media screen and (min-width: 500px) and (min-width: breakpoint(fhd)){.margin-content[_ngcontent-%COMP%]   .videos[_ngcontent-%COMP%], .margin-content[_ngcontent-%COMP%]   .playlists[_ngcontent-%COMP%]{grid-column-gap:2%;column-gap:2%}}@supports (margin-inline-start: var(--horizontalMarginContent)){.display-as-row.videos[_ngcontent-%COMP%]{margin-inline-start:var(--horizontalMarginContent)}}@supports not (margin-inline-start: var(--horizontalMarginContent)){.display-as-row.videos[_ngcontent-%COMP%]{margin-left:var(--horizontalMarginContent)}}@supports (margin-inline-end: var(--horizontalMarginContent)){.display-as-row.videos[_ngcontent-%COMP%]{margin-inline-end:var(--horizontalMarginContent)}}@supports not (margin-inline-end: var(--horizontalMarginContent)){.display-as-row.videos[_ngcontent-%COMP%]{margin-right:var(--horizontalMarginContent)}}.display-as-row.videos[_ngcontent-%COMP%]   .video-wrapper[_ngcontent-%COMP%]{margin-bottom:15px}@media screen and (max-width: 500px){.videos-header[_ngcontent-%COMP%], my-video-filters-header[_ngcontent-%COMP%]{display:inline-block}@supports (margin-inline-start: 15px){.videos-header[_ngcontent-%COMP%], my-video-filters-header[_ngcontent-%COMP%]{margin-inline-start:15px}}@supports not (margin-inline-start: 15px){.videos-header[_ngcontent-%COMP%], my-video-filters-header[_ngcontent-%COMP%]{margin-left:15px}}@supports (margin-inline-end: 15px){.videos-header[_ngcontent-%COMP%], my-video-filters-header[_ngcontent-%COMP%]{margin-inline-end:15px}}@supports not (margin-inline-end: 15px){.videos-header[_ngcontent-%COMP%], my-video-filters-header[_ngcontent-%COMP%]{margin-right:15px}}.date-title[_ngcontent-%COMP%]{text-align:center}.videos-header[_ngcontent-%COMP%]{flex-direction:column;align-items:center;height:auto;margin-bottom:10px}.videos-header[_ngcontent-%COMP%]   .title-page[_ngcontent-%COMP%]{margin-bottom:10px}@supports (margin-inline-end: 0){.videos-header[_ngcontent-%COMP%]   .title-page[_ngcontent-%COMP%]{margin-inline-end:0}}@supports not (margin-inline-end: 0){.videos-header[_ngcontent-%COMP%]   .title-page[_ngcontent-%COMP%]{margin-right:0}}}"]}),r})()},2461:(Q,P,o)=>{o.d(P,{P:()=>U});var i=o(64033),t=o(42741),n=o(62026),c=o(54755),A=o(16274),e=o(66717),_=o(69469),M=o(24333),T=o(93324);function h(u,f){if(1&u&&(t.TgZ(0,"div",3),t.SDv(1,4),t.qZA()),2&u){const O=t.oxw();t.xp6(1),t.pQV(O.noResultMessage),t.QtT(1)}}function b(u,f){if(1&u){const O=t.EpF();t.TgZ(0,"div",10),t.TgZ(1,"my-peertube-checkbox",11),t.NdJ("ngModelChange",function(L){t.CHM(O);const k=t.oxw().$implicit;return t.oxw()._selection[k.id]=L}),t.qZA(),t.qZA()}if(2&u){const O=t.oxw().$implicit,D=t.oxw();t.xp6(1),t.Q6J("inputName","video-check-"+O.id)("ngModel",D._selection[O.id])}}function H(u,f){1&u&&t.GkF(0)}function w(u,f){if(1&u){const O=t.EpF();t.TgZ(0,"div",12),t.TgZ(1,"div",13),t.TgZ(2,"span",14),t.NdJ("click",function(){return t.CHM(O),t.oxw(2).abortSelectionMode()}),t.SDv(3,15),t.qZA(),t.YNc(4,H,1,0,"ng-container",16),t.qZA(),t.qZA()}if(2&u){const O=t.oxw(2);t.xp6(4),t.Q6J("ngTemplateOutlet",O.globalButtonsTemplate)}}function Y(u,f){1&u&&t.GkF(0)}const W=function(u){return{$implicit:u}};function z(u,f){if(1&u&&(t.ynx(0),t.YNc(1,Y,1,0,"ng-container",17),t.BQk()),2&u){const O=t.oxw().$implicit,D=t.oxw();t.xp6(1),t.Q6J("ngTemplateOutlet",D.rowButtonsTemplate)("ngTemplateOutletContext",t.VKq(2,W,O))}}function I(u,f){if(1&u&&(t.TgZ(0,"div",5),t.YNc(1,b,2,2,"div",6),t._UZ(2,"my-video-miniature",7),t.YNc(3,w,5,1,"div",8),t.YNc(4,z,2,4,"ng-container",9),t.qZA()),2&u){const O=f.$implicit,D=f.index,L=t.oxw();t.xp6(1),t.Q6J("ngIf",L.enableSelection),t.xp6(1),t.Q6J("video",O)("displayAsRow",!0)("displayOptions",L.miniatureDisplayOptions)("displayVideoActions",!1)("user",L.user),t.xp6(1),t.Q6J("ngIf",!0===L.isInSelectionMode()&&0===D),t.xp6(1),t.Q6J("ngIf",!1===L.isInSelectionMode())}}let U=(()=>{class u{constructor(O){this.notifier=O,this.noResultMessage="No results.",this.enableSelection=!0,this.disabled=!1,this.selectionChange=new t.vpe,this.videosModelChange=new t.vpe,this._selection={},this.videos=[],this.sort="-publishedAt",this.onDataSubject=new i.x,this.hasDoneFirstQuery=!1}get selection(){return this._selection}set selection(O){this._selection=O,this.selectionChange.emit(this._selection)}get videosModel(){return this.videos}set videosModel(O){this.videos=O,this.videosModelChange.emit(this.videos)}ngAfterContentInit(){{const O=this.templates.find(D=>"rowButtons"===D.name);O&&(this.rowButtonsTemplate=O.template)}{const O=this.templates.find(D=>"globalButtons"===D.name);O&&(this.globalButtonsTemplate=O.template)}this.loadMoreVideos()}getVideosObservable(O){return this.getVideosObservableFunction(O,this.sort)}abortSelectionMode(){this._selection={}}isInSelectionMode(){return Object.keys(this._selection).some(O=>!0===this._selection[O])}videoById(O,D){return D.id}onNearOfBottom(){this.disabled||void 0!==this.lastQueryLength&&this.lastQueryLength<this.pagination.itemsPerPage||(this.pagination.currentPage+=1,this.loadMoreVideos())}loadMoreVideos(O=!1){this.getVideosObservable(this.pagination.currentPage).subscribe({next:({data:D})=>{this.hasDoneFirstQuery=!0,this.lastQueryLength=D.length,O&&(this.videos=[]),this.videos=this.videos.concat(D),this.videosModel=this.videos,this.onDataSubject.next(D)},error:D=>{const L="Cannot load more videos. Try again later.";console.error(L,{err:D}),this.notifier.error(L)}})}reloadVideos(){this.pagination.currentPage=1,this.loadMoreVideos(!0)}removeVideoFromArray(O){this.videos=this.videos.filter(D=>D.id!==O.id)}}return u.\u0275fac=function(O){return new(O||u)(t.Y36(c.d4))},u.\u0275cmp=t.Xpm({type:u,selectors:[["my-videos-selection"]],contentQueries:function(O,D,L){if(1&O&&t.Suo(L,n.YL,4),2&O){let k;t.iGM(k=t.CRH())&&(D.templates=k)}},inputs:{user:"user",pagination:"pagination",titlePage:"titlePage",miniatureDisplayOptions:"miniatureDisplayOptions",noResultMessage:"noResultMessage",enableSelection:"enableSelection",disabled:"disabled",getVideosObservableFunction:"getVideosObservableFunction",selection:"selection",videosModel:"videosModel"},outputs:{selectionChange:"selectionChange",videosModelChange:"videosModelChange"},decls:3,vars:6,consts:function(){let f,O;return f="\n          " + "\ufffd0\ufffd" + "\n        ",O="\n      Anullar\n    ",[["class","no-results",4,"ngIf"],["myInfiniteScroller","",1,"videos",3,"dataObservable","parentDisabled","setAngularState","nearOfBottom"],["class","video",4,"ngFor","ngForOf","ngForTrackBy"],[1,"no-results"],f,[1,"video"],["class","checkbox-container",4,"ngIf"],[3,"video","displayAsRow","displayOptions","displayVideoActions","user"],["class","action-selection-mode",4,"ngIf"],[4,"ngIf"],[1,"checkbox-container"],[3,"inputName","ngModel","ngModelChange"],[1,"action-selection-mode"],[1,"action-selection-mode-child"],[1,"action-button","action-button-cancel-selection",3,"click"],O,[4,"ngTemplateOutlet"],[4,"ngTemplateOutlet","ngTemplateOutletContext"]]},template:function(O,D){1&O&&(t.YNc(0,h,2,1,"div",0),t.TgZ(1,"div",1),t.NdJ("nearOfBottom",function(){return D.onNearOfBottom()}),t.YNc(2,I,5,8,"div",2),t.qZA()),2&O&&(t.Q6J("ngIf",D.hasDoneFirstQuery&&0===D.videos.length),t.xp6(1),t.Q6J("dataObservable",D.onDataSubject.asObservable())("parentDisabled",D.disabled)("setAngularState",!0),t.xp6(1),t.Q6J("ngForOf",D.videos)("ngForTrackBy",D.videoById))},directives:[A.O5,e.A,A.sg,_.v,M.P,T.JJ,T.On,A.tP],styles:[".action-selection-mode[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;flex-grow:1}.action-selection-mode-child[_ngcontent-%COMP%]{position:fixed}.action-selection-mode-child[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{display:block}@supports (margin-inline-start: 55px){.action-selection-mode-child[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{margin-inline-start:55px}}@supports not (margin-inline-start: 55px){.action-selection-mode-child[_ngcontent-%COMP%]   .action-button[_ngcontent-%COMP%]{margin-left:55px}}.action-button-cancel-selection[_ngcontent-%COMP%]{padding-top:0;padding-bottom:0;border:0;font-weight:600;font-size:15px;height:30px;line-height:30px;border-radius:3px!important;text-align:center;cursor:pointer;background-color:#e5e5e5;color:var(--greyForegroundColor)}@supports (padding-inline-start: 13px){.action-button-cancel-selection[_ngcontent-%COMP%]{padding-inline-start:13px}}@supports not (padding-inline-start: 13px){.action-button-cancel-selection[_ngcontent-%COMP%]{padding-left:13px}}@supports (padding-inline-end: 17px){.action-button-cancel-selection[_ngcontent-%COMP%]{padding-inline-end:17px}}@supports not (padding-inline-end: 17px){.action-button-cancel-selection[_ngcontent-%COMP%]{padding-right:17px}}.action-button-cancel-selection[_ngcontent-%COMP%]:focus, .action-button-cancel-selection.focus-visible[_ngcontent-%COMP%]{box-shadow:0 0 0 .2rem #5858580d}.action-button-cancel-selection[_ngcontent-%COMP%]:hover, .action-button-cancel-selection[_ngcontent-%COMP%]:active, .action-button-cancel-selection[_ngcontent-%COMP%]:focus, .action-button-cancel-selection[disabled][_ngcontent-%COMP%], .action-button-cancel-selection.disabled[_ngcontent-%COMP%]{color:var(--greyForegroundColor);background-color:#efefef}.action-button-cancel-selection[disabled][_ngcontent-%COMP%], .action-button-cancel-selection.disabled[_ngcontent-%COMP%]{cursor:default}.action-button-cancel-selection[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .feather, .action-button-cancel-selection[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .material, .action-button-cancel-selection[_ngcontent-%COMP%]   my-global-icon[_ngcontent-%COMP%]     .misc{color:var(--greyForegroundColor)}.video[_ngcontent-%COMP%]{display:flex;min-height:130px;padding-bottom:20px;margin-bottom:20px;border-bottom:1px solid #C6C6C6}@media screen and (max-width: 800px){.video[_ngcontent-%COMP%]{min-height:initial;padding-bottom:10px;margin-bottom:10px}}.video[_ngcontent-%COMP%]:first-child{margin-top:47px}.video[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{display:flex;align-items:center}@supports (margin-inline-end: 20px){.video[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{margin-inline-end:20px}}@supports not (margin-inline-end: 20px){.video[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{margin-right:20px}}@supports (margin-inline-start: 12px){.video[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{margin-inline-start:12px}}@supports not (margin-inline-start: 12px){.video[_ngcontent-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{margin-left:12px}}.video[_ngcontent-%COMP%]   my-video-miniature[_ngcontent-%COMP%]{flex-grow:1}@media screen and (max-width: 1040px){.main-col:not(.expanded)[_nghost-%COMP%]   .video[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .video[_ngcontent-%COMP%]{flex-wrap:wrap}}@media screen and (max-width: 800px){.main-col.expanded[_nghost-%COMP%]   .video[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .video[_ngcontent-%COMP%]{flex-wrap:wrap}}@media screen and (max-width: 740px){.main-col:not(.expanded)[_nghost-%COMP%]   .checkbox-container[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{display:none}.main-col:not(.expanded)[_nghost-%COMP%]   .action-selection-mode[_ngcontent-%COMP%], .main-col:not(.expanded)   [_nghost-%COMP%]   .action-selection-mode[_ngcontent-%COMP%]{display:none}}@media screen and (max-width: 500px){.main-col.expanded[_nghost-%COMP%]   .checkbox-container[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .checkbox-container[_ngcontent-%COMP%]{display:none}.main-col.expanded[_nghost-%COMP%]   .action-selection-mode[_ngcontent-%COMP%], .main-col.expanded   [_nghost-%COMP%]   .action-selection-mode[_ngcontent-%COMP%]{display:none}}"]}),u})()},34494:(Q,P,o)=>{o.d(P,{A:()=>n});var i=o(13010),t=o(42741);let n=(()=>{class c{}return c.\u0275fac=function(e){return new(e||c)},c.\u0275mod=t.oAB({type:c}),c.\u0275inj=t.cJS({imports:[[i.n]]}),c})()},22394:(Q,P,o)=>{o.d(P,{M:()=>e});var i=o(42741),t=o(16274),n=o(53067);function c(_,M){if(1&_&&(i.ynx(0),i.SDv(1,2),i.ALo(2,"myNumberFormatter"),i.BQk()),2&_){const T=i.oxw();i.xp6(2),i.pQV(T.video.views)(i.lcZ(2,2,T.video.views)),i.QtT(1)}}function A(_,M){if(1&_&&(i.ynx(0),i.SDv(1,3),i.ALo(2,"myNumberFormatter"),i.BQk()),2&_){const T=i.oxw();i.xp6(2),i.pQV(T.video.views)(i.lcZ(2,2,T.video.views)),i.QtT(1)}}let e=(()=>{class _{}return _.\u0275fac=function(T){return new(T||_)},_.\u0275cmp=i.Xpm({type:_,selectors:[["my-video-views-counter"]],inputs:{video:"video"},decls:3,vars:3,consts:function(){let M,T,h,b;return M="{VAR_PLURAL, plural, =1 {1 visualizacion} other {{INTERPOLATION} visualizacions}}\n        ",M=i.Zx4(M,{VAR_PLURAL:"\ufffd0\ufffd",INTERPOLATION:"\ufffd1\ufffd"}),T=" " + M + " ",h="{VAR_PLURAL, plural, =1 {1 viewer} other {{INTERPOLATION} viewers}}",h=i.Zx4(h,{VAR_PLURAL:"\ufffd0\ufffd",INTERPOLATION:"\ufffd1\ufffd"}),b=" " + h + " ",[[3,"title"],[4,"ngIf"],T,b]},template:function(T,h){1&T&&(i.TgZ(0,"span",0),i.YNc(1,c,3,4,"ng-container",1),i.YNc(2,A,3,4,"ng-container",1),i.qZA()),2&T&&(i.Q6J("title",h.video.getExactNumberOfViews()),i.xp6(1),i.Q6J("ngIf",!h.video.isLive),i.xp6(1),i.Q6J("ngIf",h.video.isLive))},directives:[t.O5],pipes:[n.m],styles:[""]}),_})()}}]);